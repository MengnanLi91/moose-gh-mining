{
  "discussions": {
    "pageInfo": {
      "hasNextPage": true,
      "endCursor": "Y3Vyc29yOnYyOpK5MjAyMi0xMC0xMlQwODozMzoxNC0wNTowMM4AMqxk"
    },
    "edges": [
      {
        "node": {
          "title": "My test ran a few steps and quit.",
          "author": {
            "login": "KangChenRui"
          },
          "bodyText": "Hello,everyone!\nMy test ran a few steps and quit.\nThe following is the report information\uff1a\n=   BAD TERMINATION OF ONE OF YOUR APPLICATION PROCESSES\n=   PID 33867 RUNNING AT cu03\n=   EXIT CODE: 9\n=   CLEANING UP REMAINING PROCESSES\n=   YOU CAN IGNORE THE BELOW CLEANUP MESSAGES\n===================================================================================\nYOUR APPLICATION TERMINATED WITH THE EXIT STRING: Killed (signal 9)\nThis typically refers to a problem with your application.\nPlease see the FAQ page for debugging suggestions\n\nCan you help me?\nChen Rui",
          "url": "https://github.com/idaholab/moose/discussions/20983",
          "updatedAt": "2022-10-14T12:38:27Z",
          "publishedAt": "2022-05-09T11:40:37Z",
          "category": {
            "name": "Q&A General"
          },
          "comments": {
            "edges": [
              {
                "node": {
                  "author": {
                    "login": "GiudGiud"
                  },
                  "bodyText": "Hello\nthis isn\u2019t enough information to see what went wrong.\ncould you please use a debugger to get us a backtrace? See this page for instructions\nhttps://mooseframework.inl.gov/application_development/debugging.html\nguillaume",
                  "url": "https://github.com/idaholab/moose/discussions/20983#discussioncomment-2714895",
                  "updatedAt": "2022-07-05T13:00:52Z",
                  "publishedAt": "2022-05-09T13:55:12Z",
                  "isAnswer": true,
                  "replies": {
                    "edges": [
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "Also could you please describe the test a little bit. What does it? Any parallelism? Is it all moose objects or is there custom ones from your app?",
                          "url": "https://github.com/idaholab/moose/discussions/20983#discussioncomment-2714900",
                          "updatedAt": "2022-07-05T13:00:57Z",
                          "publishedAt": "2022-05-09T13:56:00Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "@KangChenRui any update on this?",
                          "url": "https://github.com/idaholab/moose/discussions/20983#discussioncomment-2755460",
                          "updatedAt": "2022-07-05T13:00:57Z",
                          "publishedAt": "2022-05-15T21:23:23Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "KangChenRui"
                          },
                          "bodyText": "Hi, GiudGiud\nI am trying to debug with debugger.\nThanks for your reply!",
                          "url": "https://github.com/idaholab/moose/discussions/20983#discussioncomment-2759549",
                          "updatedAt": "2022-07-05T13:00:57Z",
                          "publishedAt": "2022-05-16T13:06:06Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "KangChenRui"
                          },
                          "bodyText": "Hi, GiudGiud\nThe following is the background output information corresponding to the inputfile.\nCan you help me?\nThanks for your reply!\nnohup.out.txt",
                          "url": "https://github.com/idaholab/moose/discussions/20983#discussioncomment-2802090",
                          "updatedAt": "2022-05-23T06:41:51Z",
                          "publishedAt": "2022-05-23T06:41:50Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "signal 9 (at the end of the log) is sigkill.\nDid you kill the process?\nOr are you running out of time on a cluster session?\nAnother possiblity is that you are running out of memory. Can you try to reduce the problem and see if it runs?\nAlso there is a postprocessor to keep track of memory usage:\nhttps://mooseframework.inl.gov/source/postprocessors/MemoryUsage.html\nThe log seems fine except for this sigkill",
                          "url": "https://github.com/idaholab/moose/discussions/20983#discussioncomment-2806166",
                          "updatedAt": "2022-05-23T17:17:30Z",
                          "publishedAt": "2022-05-23T17:17:29Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "Adairle"
                          },
                          "bodyText": "EnvironmentNameNotFound: Could not find conda environment: moose\nYou can list all discoverable environments with conda info --envs.\nThat's it\nLook forward to your reply, thank you\uff01",
                          "url": "https://github.com/idaholab/moose/discussions/20983#discussioncomment-3876998",
                          "updatedAt": "2023-06-05T14:43:10Z",
                          "publishedAt": "2022-10-14T08:25:26Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "You should re-install the environment.\nhttps://mooseframework.inl.gov/getting_started/installation/conda.html",
                          "url": "https://github.com/idaholab/moose/discussions/20983#discussioncomment-3878787",
                          "updatedAt": "2022-10-14T12:38:27Z",
                          "publishedAt": "2022-10-14T12:38:27Z",
                          "isAnswer": false
                        }
                      }
                    ]
                  }
                }
              }
            ]
          }
        }
      },
      {
        "node": {
          "title": "Transfering between subdomains",
          "author": {
            "login": "salaudeen-ya"
          },
          "bodyText": "Hello,\nPlease I am trying to use domain decomposition features for a simple BVP equation with two subdomains.\nI have issues transferring calculated variable from one domain to the other other domain.\nIt is telling me my auxvariable in the second domain is defined, which is clearly not.\n\nMy error, parent input file and sub input file are attached.\n---------Main input file ----------------\n[Mesh]\n  type = GeneratedMesh\n  dim = 1\n  nx = 1\n  xmax = 1\n[]\n\n[Variables]\n  [u]\n  []\n[]\n\n[AuxVariables]\n  [flux_var_u]\n    order = CONSTANT\n    family = MONOMIAL\n  []\n[]\n\n[Kernels]\n  [diff]\n    type = MatDiffusion\n    variable = u\n    diffusivity = 2\n  []\n  [reaction]\n    type = Reaction\n    variable = u\n    rate = 0.5\n  []\n  [bodyforce]\n    type = BodyForce\n    variable = u\n    value = 1.\n  []\n  [td]\n    type = TimeDerivative\n    variable = u\n  []\n[]\n\n[AuxKernels]\n  [fluxKernel]\n    type = DiffusionFluxAux\n    diffusivity = 2\n    variable = flux_var_u\n    diffusion_variable = u\n    component = x\n  []\n[]\n\n[BCs]\n  [left]\n    type = NeumannBC\n    variable = u\n    boundary = left\n    value = -3\n  []\n  [right]\n    type = DirichletBC\n    variable = u\n    boundary = right\n    value = 0\n  []\n[]\n\n[Postprocessors]\n  [average]\n    type = ElementAverageValue\n    variable = u\n  []\n[]\n\n[Executioner]\n\n  type = Transient\n  solve_type = 'PJFNK'\n  nl_rel_tol = 1e-12\n  \n  #end_time = 2\n  #dt = 0.2\n\n  picard_max_its = 10\n\n  nl_abs_tol = 1e-10\n  picard_rel_tol = 1e-6\n  picard_abs_tol = 1e-10\n\n  num_steps = 5\n  petsc_options_iname = '-pc_type -pc_hypre_type'\n  petsc_options_value = 'hypre boomeramg'\n[]\n\n[Outputs]\n  exodus = true\n[]\n\n[MultiApps]\n  [micro]\n    type = TransientMultiApp\n    positions = '0.5 0 0'\n    input_files = 'sub_input.i'\n    execute_on = timestep_end\n    output_in_position = true\n  []\n[]\n\n[Transfers]\n  [push_u]\n    type = MultiAppPostprocessorToAuxScalarTransfer\n    to_multi_app = micro\n    from_postprocessor = average\n    to_aux_scalar = flux_var_v\n  []\n\n  [pull_v]\n    type = MultiAppPostprocessorInterpolationTransfer\n    from_multi_app = micro\n    variable = flux_var_u\n    postprocessor = vt\n  []\n[]\n\n\n\n----------Sub input file---------------\n[Mesh]\n  type = GeneratedMesh\n  dim = 1\n  nx = 1\n  xmax = 1\n[]\n\n[Variables]\n  [v]\n  []\n[]\n\n[AuxVariables]\n  [flux_var_v]\n    order = CONSTANT\n    family = MONOMIAL\n  []\n[]\n\n[Kernels]\n  [diff]\n    type = Diffusion\n    variable = v\n    #diffusivity = 2\n  []\n\n  [reaction]\n    type = Reaction\n    variable = v\n    rate = 0.5\n  []\n\n  [body_force]\n    type = BodyForce\n    variable = v\n    value = 1\n  []\n\n  [td]\n    type = TimeDerivative\n    variable = v\n  []\n[]\n\n[AuxKernels]\n  [fluxKernel]\n    type = DiffusionFluxAux\n    diffusivity = 2\n    variable = flux_var_v\n    diffusion_variable = v\n    component = x\n  []\n[]\n\n[BCs]\n  [left]\n    type = DirichletBC\n    variable = v\n    boundary = left\n    value = 0\n  []\n  [right]\n    type = DirichletBC\n    variable = v\n    boundary = right\n    value = 0\n  []\n[]\n\n[Postprocessors]  # calc a single scalar (real) value\n  [vt]\n    type = ScalarVariable\n    variable = flux_var_v\n  []\n[]\n\n[Executioner]\n  type = Transient\n  end_time = 2\n  dt = 0.2\n\n  nl_abs_tol = 1e-10\n\n  solve_type = 'PJFNK'\n\n  petsc_options_iname = '-pc_type -pc_hypre_type'\n  petsc_options_value = 'hypre boomeramg'\n[]\n\n[Outputs]\n  exodus = true\n[]\n\nThanks you!!",
          "url": "https://github.com/idaholab/moose/discussions/22371",
          "updatedAt": "2022-10-14T03:51:33Z",
          "publishedAt": "2022-10-11T17:48:16Z",
          "category": {
            "name": "Q&A General"
          },
          "comments": {
            "edges": [
              {
                "node": {
                  "author": {
                    "login": "GiudGiud"
                  },
                  "bodyText": "Hello\nMultiAppPostprocessorToAuxScalarTransfer is the wrong transfer here.\nYou are transferring to a field auxiliary variables, not a scalar one.\nThe transfer for that is\nhttps://mooseframework.inl.gov/source/transfers/MultiAppVariableValueSamplePostprocessorTransfer.html\nGuillaume",
                  "url": "https://github.com/idaholab/moose/discussions/22371#discussioncomment-3854140",
                  "updatedAt": "2022-10-11T20:15:41Z",
                  "publishedAt": "2022-10-11T20:15:40Z",
                  "isAnswer": true,
                  "replies": {
                    "edges": []
                  }
                }
              },
              {
                "node": {
                  "author": {
                    "login": "salaudeen-ya"
                  },
                  "bodyText": "Thank you for your response. I changed it to the Variable Value Sampler too\nand I was still hooked somewhere.\nI will have to use one of the examples as a starting point, and build from\nthere.\n\nThank you!\n\u2026\nOn Tue, 11 Oct 2022 at 16:15, Guillaume Giudicelli ***@***.***> wrote:\n Hello\n\n MultiAppPostprocessorToAuxScalarTransfer is the wrong transfer here.\n You are transferring to a field auxiliary variables, not a scalar one.\n The transfer for that is\n\n https://mooseframework.inl.gov/source/transfers/MultiAppVariableValueSamplePostprocessorTransfer.html\n\n Guillaume\n\n \u2014\n Reply to this email directly, view it on GitHub\n <#22371 (comment)>,\n or unsubscribe\n <https://github.com/notifications/unsubscribe-auth/AJCC7Q5ZYDN6KZPSXPHZPDLWCXDHPANCNFSM6AAAAAARCQWL34>\n .\n You are receiving this because you authored the thread.Message ID:\n ***@***.***>",
                  "url": "https://github.com/idaholab/moose/discussions/22371#discussioncomment-3854806",
                  "updatedAt": "2022-10-11T22:23:55Z",
                  "publishedAt": "2022-10-11T22:23:54Z",
                  "isAnswer": false,
                  "replies": {
                    "edges": []
                  }
                }
              }
            ]
          }
        }
      },
      {
        "node": {
          "title": "what kernel should be used for the bulk free energy part of Moelans (2011) paper",
          "author": {
            "login": "yixishen"
          },
          "bodyText": "Hi there,\nI am trying to apply the approach in Moelans(2011) paper Acta Material 59 (2011) 1077-1086 on multi-phase model.\nAttached is the evolution of the non-conserved order parameter. The first part is used to describe surface free energy and the second circled part is used to describe bulk free energy\n\nI have found kernel ACGrGrMulti can be used for surface free energy part, but I have not found any kernel for the bulk energy part.\nAny idea for this?\nBest\nYixi",
          "url": "https://github.com/idaholab/moose/discussions/22375",
          "updatedAt": "2022-10-22T00:02:30Z",
          "publishedAt": "2022-10-12T00:41:06Z",
          "category": {
            "name": "Q&A Modules: Phase field"
          },
          "comments": {
            "edges": [
              {
                "node": {
                  "author": {
                    "login": "GiudGiud"
                  },
                  "bodyText": "@dschwen @laagesen",
                  "url": "https://github.com/idaholab/moose/discussions/22375#discussioncomment-3855380",
                  "updatedAt": "2022-10-12T00:52:34Z",
                  "publishedAt": "2022-10-12T00:52:34Z",
                  "isAnswer": true,
                  "replies": {
                    "edges": [
                      {
                        "node": {
                          "author": {
                            "login": "laagesen"
                          },
                          "bodyText": "Hi Yixi, unfortunately we do not currently have any existing kernels for the boxed part of the equation. You would need to write some code to implement this. We would welcome a contribution if you do so!",
                          "url": "https://github.com/idaholab/moose/discussions/22375#discussioncomment-3873837",
                          "updatedAt": "2022-10-13T21:08:23Z",
                          "publishedAt": "2022-10-13T21:08:22Z",
                          "isAnswer": false
                        }
                      }
                    ]
                  }
                }
              }
            ]
          }
        }
      },
      {
        "node": {
          "title": "VSCode setup",
          "author": {
            "login": "joe61vette"
          },
          "bodyText": "Was dismayed to see atom being sunsetted.  But thanks to Moose team for giving us an alternative.\nI made it to the \"Recommended settings\" step of the instructions.  Where and how do I add this to VSCode?  For example, do I save it in a file with a special name? etc.  In VSCode, I can open the settings but there are thousands of things.  I have no idea where to put the provided code.\nThanks,\nJoe Kelly",
          "url": "https://github.com/idaholab/moose/discussions/22390",
          "updatedAt": "2022-10-13T18:23:50Z",
          "publishedAt": "2022-10-13T16:35:21Z",
          "category": {
            "name": "Q&A Getting Started"
          },
          "comments": {
            "edges": [
              {
                "node": {
                  "author": {
                    "login": "GiudGiud"
                  },
                  "bodyText": "Hi Joe\nYeah in VSCode you need to press: shift cmd P to pull up the settings bar\nThen Preferences: Open User Settings\nand paste it there\nBest,\nGuillaume",
                  "url": "https://github.com/idaholab/moose/discussions/22390#discussioncomment-3872124",
                  "updatedAt": "2022-10-13T16:58:50Z",
                  "publishedAt": "2022-10-13T16:58:32Z",
                  "isAnswer": false,
                  "replies": {
                    "edges": [
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "I ll add it to the docs",
                          "url": "https://github.com/idaholab/moose/discussions/22390#discussioncomment-3872127",
                          "updatedAt": "2022-10-13T16:58:57Z",
                          "publishedAt": "2022-10-13T16:58:56Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "hugary1995"
                          },
                          "bodyText": "IIRC there are Open User Settings (UI), Open User Settings (json), Open Workspace Settings (UI) and Open Workspace Settings (json).\nUser settings will be the global settings for all projects, while Workspace settings is specific to each project (it will actually save the settings in json format in the .vscode folder in the current workspace). Depending on your actual need, you may have to choose between user settings and workspace settings.\nUI will open settings inside vscode with some nice user interface, and json is its reflection in json format. They should be interoperable.",
                          "url": "https://github.com/idaholab/moose/discussions/22390#discussioncomment-3872316",
                          "updatedAt": "2022-10-13T17:27:17Z",
                          "publishedAt": "2022-10-13T17:27:17Z",
                          "isAnswer": false
                        }
                      }
                    ]
                  }
                }
              },
              {
                "node": {
                  "author": {
                    "login": "milljm"
                  },
                  "bodyText": "I always have to refer to past instructions as well. I believe you're after editing your workbench settings for that portion. Straight from my own notes (this is for Macintosh machines. The short cut keys will be different for Linux users:\nedit the setting.json using keys `cmd+,` (command + comma), search for `workbench color`,\nClick `Edit in settings.json`, append the following...\n\n... the following being what ever it was you are trying to add/or edit to workbench settings, in json format. It's a button at the top right (for me). See attached picture.",
                  "url": "https://github.com/idaholab/moose/discussions/22390#discussioncomment-3872134",
                  "updatedAt": "2022-10-13T16:59:46Z",
                  "publishedAt": "2022-10-13T16:59:45Z",
                  "isAnswer": true,
                  "replies": {
                    "edges": [
                      {
                        "node": {
                          "author": {
                            "login": "joe61vette"
                          },
                          "bodyText": "The key was finding the \"edit JSON Button\".\nThanks for the help everyone.\nJoe",
                          "url": "https://github.com/idaholab/moose/discussions/22390#discussioncomment-3872741",
                          "updatedAt": "2022-10-13T18:23:50Z",
                          "publishedAt": "2022-10-13T18:23:50Z",
                          "isAnswer": false
                        }
                      }
                    ]
                  }
                }
              }
            ]
          }
        }
      },
      {
        "node": {
          "title": "How to find the areal mean of a 3D variable",
          "author": {
            "login": "js-jixu"
          },
          "bodyText": "Hi, everyone.\nI have a 3D square flow channel, and I want to calculate the convective heat transfer coefficient of its walls, which requires me to get the Reynolds number. In a 3D model, the velocity is a function of (x, y, z) and I want to know the average velocity at z. This requires an area integral of velocity(x,y,z) on the xy plane, and then dividing by the channel area on the xy plane. Similarly, material properties rho, mu, k, cp are also functions of (x, y, z), and I want to get their average value at coordinate z. What object should be used in MOOSE to accomplish this?",
          "url": "https://github.com/idaholab/moose/discussions/22061",
          "updatedAt": "2022-10-13T06:27:33Z",
          "publishedAt": "2022-09-09T12:48:26Z",
          "category": {
            "name": "Q&A General"
          },
          "comments": {
            "edges": [
              {
                "node": {
                  "author": {
                    "login": "GiudGiud"
                  },
                  "bodyText": "Hello\nThere is an AreaPostprocessor, you ll just need to add a sideset on what you want to measure\nGuillaume",
                  "url": "https://github.com/idaholab/moose/discussions/22061#discussioncomment-3764696",
                  "updatedAt": "2022-09-29T16:53:41Z",
                  "publishedAt": "2022-09-29T16:53:40Z",
                  "isAnswer": true,
                  "replies": {
                    "edges": [
                      {
                        "node": {
                          "author": {
                            "login": "js-jixu"
                          },
                          "bodyText": "I take a look at AreaPostprocessor , but I don't think it might solve my problem. I think my description might not be very clear. Imagine that, you have a square pipe with fluid flowing through it. And you want to get the Reynolds number of the fluid along the pipe and use it as a Material or Postprocessor for subsequent coupling calculations. So how to get the average velocity of water in each radial section in the pipe?",
                          "url": "https://github.com/idaholab/moose/discussions/22061#discussioncomment-3780222",
                          "updatedAt": "2022-10-02T04:26:03Z",
                          "publishedAt": "2022-10-02T04:26:02Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "You can take an take an average using the ratio of a volumetric flow rate postprocessor and the area postprocessor\nThere is also a volumetric Reynolds postprocessor you can use",
                          "url": "https://github.com/idaholab/moose/discussions/22061#discussioncomment-3781624",
                          "updatedAt": "2022-10-02T13:43:18Z",
                          "publishedAt": "2022-10-02T13:43:18Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "js-jixu"
                          },
                          "bodyText": "This is a very enlightening approach. It helped me a lot.",
                          "url": "https://github.com/idaholab/moose/discussions/22061#discussioncomment-3787029",
                          "updatedAt": "2022-10-03T12:18:40Z",
                          "publishedAt": "2022-10-03T12:18:39Z",
                          "isAnswer": false
                        }
                      }
                    ]
                  }
                }
              },
              {
                "node": {
                  "author": {
                    "login": "friedmud"
                  },
                  "bodyText": "You can use the SideAverageValue postprocessor to find the value of a variable over a sideset.  You can also inherit from it and override computeQpIntegral() to find the average of anything you can compute.",
                  "url": "https://github.com/idaholab/moose/discussions/22061#discussioncomment-3790702",
                  "updatedAt": "2022-10-03T20:36:36Z",
                  "publishedAt": "2022-10-03T20:36:35Z",
                  "isAnswer": false,
                  "replies": {
                    "edges": [
                      {
                        "node": {
                          "author": {
                            "login": "friedmud"
                          },
                          "bodyText": "Here is the doco for that: https://mooseframework.inl.gov/source/postprocessors/SideAverageValue.html",
                          "url": "https://github.com/idaholab/moose/discussions/22061#discussioncomment-3790724",
                          "updatedAt": "2022-10-03T20:41:33Z",
                          "publishedAt": "2022-10-03T20:41:32Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "For flow sims, the VolumetricFlowRate is better. Works across discretizations and lets you consider whichever quantities you could really want (average velocity is rarely the one)",
                          "url": "https://github.com/idaholab/moose/discussions/22061#discussioncomment-3790743",
                          "updatedAt": "2022-10-03T20:45:54Z",
                          "publishedAt": "2022-10-03T20:45:54Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "js-jixu"
                          },
                          "bodyText": "Hi, experts. I have tried some methods these days, but still can't get the effect I want. I will rephrase my problem again, and for the convenience of testing and understanding, I will introduce it with a two-dimensional model. And generalization from 2D to 3D is easy.\nI have a model of fluid-solid conjugate heat transfer. Obviously, the convective heat transfer coefficient at the fluid-solid interface should be a function of flow conditions (eg velocity):\n\nI want to get htc using Peclet number, and I created a Peclet number in Materials block:\n  [./Pe_fluid]\n    type = ADParsedMaterial\n    f_name = Pe\n    function = 'speed * ${L} / (k / (rho * cp))'\n    material_property_names = 'k rho cp'\n    args = 'speed'\n    block = fluid\n  [../]\n\nNow there is a Pe on each element in the fluid area. In other words, Pe is a function of x and y, that is, Pe=f(x,y). But htc is a function of y. So I want to get the mean of Pe at each y. For sidesets, I only have sidesets of boundaries. Is there any object in MOOSE that can achieve this?",
                          "url": "https://github.com/idaholab/moose/discussions/22061#discussioncomment-3829258",
                          "updatedAt": "2022-10-08T15:27:26Z",
                          "publishedAt": "2022-10-08T15:26:52Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "you should have a look at the layered average objects, that does exactly that, in many variations\nhttps://mooseframework.inl.gov/source/userobject/NearestPointLayeredAverage.html",
                          "url": "https://github.com/idaholab/moose/discussions/22061#discussioncomment-3829277",
                          "updatedAt": "2022-10-08T15:30:46Z",
                          "publishedAt": "2022-10-08T15:30:45Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "js-jixu"
                          },
                          "bodyText": "Can this object be used in coupled computations? Obviously, htc affects velocity (or Pe), which in turn affects htc. If I get the average Pe by using this object, can objects in other blocks use the results?",
                          "url": "https://github.com/idaholab/moose/discussions/22061#discussioncomment-3829342",
                          "updatedAt": "2022-10-08T15:44:45Z",
                          "publishedAt": "2022-10-08T15:44:44Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "This stores the result in an auxiliary variable.\nThat auxiliary variable may be coupled anywhere afterwards",
                          "url": "https://github.com/idaholab/moose/discussions/22061#discussioncomment-3829523",
                          "updatedAt": "2022-10-08T16:14:10Z",
                          "publishedAt": "2022-10-08T16:14:09Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "js-jixu"
                          },
                          "bodyText": "I used LayeredAverage to get layer average value, so that I can avoid setting the Points in NearestPointLayeredAverage. The method I use is cumbersome and superfluous (in the opinion of someone who is proficient in MOOSE) and I encountered some problems when I use the htc.\nIf I want to know the layer average value of Pe or Nu, then I need to know the layer average values of rho, cp, k and speed. So I first use ADMaterialRealAux to take out the rho, cp, k of the fluid area in Materials, and store them in the AuxVariables rho_fluid, cp_fluid, k_fluid. Then I use SpatialUserObjectAux and LayeredAverage to get the layer average values of rho_fluid, cp_fluid, k_fluid and store them in new AuxVariables ave_rho_fluid, ave_cp_fluid, ave_k_fluid. Finally I use ADParsedMaterial block to define the Pe and Nu I want in Materials block, and use Nu and ave_k_fluid to get htc. The related syntax is here:\n[AuxVariables]\n  [./speed]\n    family = MONOMIAL\n\torder = CONSTANT\n\tblock = 'fluid'\n  [../]\n  [./ave_speed]\n    family = MONOMIAL\n\torder = CONSTANT\n\tblock = 'fluid'\n  [../]\n  [./rho_fluid]\n    family = MONOMIAL\n\torder = CONSTANT\n\tblock = 'fluid'\n  [../]\n  [./ave_rho_fluid]\n    family = MONOMIAL\n\torder = CONSTANT\n\tblock = 'fluid'\n  [../]\n  [./k_fluid]\n    family = MONOMIAL\n\torder = CONSTANT\n\tblock = 'fluid'\n  [../]\n  [./ave_k_fluid]\n    family = MONOMIAL\n\torder = CONSTANT\n\tblock = 'fluid'\n  [../]\n  [./cp_fluid]\n    family = MONOMIAL\n\torder = CONSTANT\n\tblock = 'fluid'\n  [../]\n  [./ave_cp_fluid]\n    family = MONOMIAL\n\torder = CONSTANT\n\tblock = 'fluid'\n  [../]\n  \n  [./Pe]\n    family = MONOMIAL\n\torder = CONSTANT\n\tblock = 'fluid'\n  [../]\n  [./Nu]\n    family = MONOMIAL\n\torder = CONSTANT\n\tblock = 'fluid'\n  [../]\n  [./heat_tran_coeff]\n    family = MONOMIAL\n\torder = CONSTANT\n\tblock = 'fluid'\n  [../]\n[]\n\n[AuxKernels]\n  [./speed_auxk]\n    type = VectorVariableMagnitudeAux\n\tvariable = speed\n\tvector_variable = velocity\n\tblock = fluid\n  [../]\n  [./ave_speed_auxk]\n    type = SpatialUserObjectAux\n\tvariable = ave_speed\n\tuser_object = ave_speed_uo\n\tblock = fluid\n  [../]\n  [./rho_fluid_auxk]\n    type = ADMaterialRealAux\n\tproperty = 'rho'\n\tvariable = rho_fluid\n\tblock = fluid\n  [../]\n  [./ave_rho_fluid_auxk]\n    type = SpatialUserObjectAux\n\tvariable = ave_rho_fluid\n\tuser_object = ave_rho_fluid_uo\n\tblock = fluid\n  [../]\n  [./k_fluid_auxk]\n    type = ADMaterialRealAux\n\tproperty = 'k'\n\tvariable = k_fluid\n\tblock = fluid\n  [../]\n  [./ave_k_fluid_auxk]\n    type = SpatialUserObjectAux\n\tvariable = ave_k_fluid\n\tuser_object = ave_k_fluid_uo\n\tblock = fluid\n  [../]\n  [./cp_fluid_auxk]\n    type = ADMaterialRealAux\n\tproperty = 'cp'\n\tvariable = cp_fluid\n\tblock = fluid\n  [../]\n  [./ave_cp_fluid_auxk]\n    type = SpatialUserObjectAux\n\tvariable = ave_cp_fluid\n\tuser_object = ave_cp_fluid_uo\n\tblock = fluid\n  [../]\n  [./Pe_auxk]\n    type = ADMaterialRealAux\n\tproperty = 'Pelect_Number'\n\tvariable = Pe\n\tblock = fluid\n  [../]\n  [./Nu_auxk]\n    type = ADMaterialRealAux\n\tproperty = 'Nusselt_Number'\n\tvariable = Nu\n\tblock = fluid\n  [../]\n[]\n\n[UserObjects]\n  [./ave_speed_uo]\n    type = LayeredAverage\n\tdirection = y\n\tnum_layers = 11\n\tvariable = speed\n\tblock = fluid\n  [../]\n  [./ave_rho_fluid_uo]\n    type = LayeredAverage\n\tdirection = y\n\tnum_layers = 11\n\tvariable = rho_fluid\n\tblock = fluid\n  [../]\n  [./ave_k_fluid_uo]\n    type = LayeredAverage\n\tdirection = y\n\tnum_layers = 11\n\tvariable = k_fluid\n\tblock = fluid\n  [../]\n  [./ave_cp_fluid_uo]\n    type = LayeredAverage\n\tdirection = y\n\tnum_layers = 11\n\tvariable = cp_fluid\n\tblock = fluid\n  [../]\n[]\n\n[Materials]\n  [./rho_fluid_mat]\n    type = ADParsedMaterial\n    f_name = rho\n    function = '(11096 - 1.3236 * Tf) * 1e-6'\n    args = 'Tf'\n    block = 'fluid'\n  [../]\n  [./cp_fluid_mat]\n    type = ADParsedMaterial\n    f_name = cp\n    function = '159 - 2.72e-2 * Tf + 7.12e-6 * pow(Tf,2)'\n    args = 'Tf'\n    block = 'fluid'\n  [../]\n  [./k_fluid_mat]\n    type = ADParsedMaterial\n    f_name = k\n    function = '(3.61 + 1.517e-2 * Tf - 1.741e-6 * pow(Tf,2)) * 1e-2'\n    args = 'Tf'\n    block = 'fluid'\n  [../]\n  [./mu_fluid_mat]\n    type = ADParsedMaterial\n    f_name = mu\n    function = '4.94e-6 * exp(754.1/Tf)'\n    args = 'Tf'\n    block = 'fluid'\n  [../]\n\n  [./Pelect_Number_mat]\n    type = ADParsedMaterial\n\tf_name = Pelect_Number\n\tfunction = 'ave_speed * ${L} / (ave_k_fluid / (ave_rho_fluid * ave_cp_fluid))'\n\targs = 'ave_speed ave_k_fluid ave_rho_fluid ave_cp_fluid'\n\tblock = fluid\n  [../]\n  [./Nusselt_Number_mat]\n    type = ADParsedMaterial\n\tf_name = Nusselt_Number\n\tfunction = '5.75 + 0.022 * pow(Pelect_Number, 0.8)'\n\tmaterial_property_names = 'Pelect_Number'\n\tblock = fluid\n  [../]\n  \n  [./htc_mat]\n    type = ADParsedMaterial\n\tf_name = htc\n\tfunction = '(Nusselt_Number * ave_k_fluid) / ${L}'\n\tmaterial_property_names = 'Nusselt_Number'\n\targs = 'ave_k_fluid'\n\t#function = '${heat_transfer_coefficient}'\n\tblock = fluid\n  [../]\n[]\n\nBut when I run the input file, it can't converge:\nTime Step 1, time = 1, dt = 1\n\nPerforming automatic scaling calculation\n\nNonlinear solve did not converge due to DIVERGED_FNORM_NAN iterations 0\n Solve Did NOT Converge!\nAborting as solve did not converge\n\nTime Step 1, time = 0.5, dt = 0.5\nNonlinear solve did not converge due to DIVERGED_FNORM_NAN iterations 0\n Solve Did NOT Converge!\nAborting as solve did not converge\n\nTime Step 1, time = 0.25, dt = 0.25\nNonlinear solve did not converge due to DIVERGED_FNORM_NAN iterations 0\n Solve Did NOT Converge!\nAborting as solve did not converge\n\nTime Step 1, time = 0.125, dt = 0.125\nNonlinear solve did not converge due to DIVERGED_FNORM_NAN iterations 0\n Solve Did NOT Converge!\nAborting as solve did not converge\n\nTime Step 1, time = 0.0625, dt = 0.0625\nNonlinear solve did not converge due to DIVERGED_FNORM_NAN iterations 0\n Solve Did NOT Converge!\nAborting as solve did not converge\n\n..............................................................................................................................................................\n\nTime Step 1, time = 1e-13, dt = 1e-13\nNonlinear solve did not converge due to DIVERGED_FNORM_NAN iterations 0\n Solve Did NOT Converge!\nAborting as solve did not converge\n\n\n*** ERROR ***\nThe following error occurred in the object \"TimeStepper\", of type \"ConstantDT\".\n\nSolve failed and timestep already at or below dtmin, cannot continue!\n\nTo test if the previous AuxVaiables would get the results I want, I set htc to a constant and run the input file.\n \nThe above figures show that Nu and Pe are calculated successfully, but why does it not converge when I use Nu to calculate htc and use the htc? Here are input files and mesh files.\n2d.zip",
                          "url": "https://github.com/idaholab/moose/discussions/22061#discussioncomment-3831411",
                          "updatedAt": "2022-10-09T15:15:25Z",
                          "publishedAt": "2022-10-09T04:32:33Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "What were you using previously for Nu and Pe? constants?\nCan you try isolating it to either Nu or Pe?",
                          "url": "https://github.com/idaholab/moose/discussions/22061#discussioncomment-3839832",
                          "updatedAt": "2022-10-10T14:12:36Z",
                          "publishedAt": "2022-10-10T14:12:35Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "js-jixu"
                          },
                          "bodyText": "I didn't set Nu and Pe before and set htc equal to a constant. But such simulations are very imprecise. So I want to use Nu to calculate htc.",
                          "url": "https://github.com/idaholab/moose/discussions/22061#discussioncomment-3840111",
                          "updatedAt": "2022-10-10T14:43:42Z",
                          "publishedAt": "2022-10-10T14:43:40Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "can you set them to constants and see what convergence is like? One at a time",
                          "url": "https://github.com/idaholab/moose/discussions/22061#discussioncomment-3840119",
                          "updatedAt": "2022-10-10T14:44:28Z",
                          "publishedAt": "2022-10-10T14:44:27Z",
                          "isAnswer": false
                        }
                      }
                    ]
                  }
                }
              }
            ]
          }
        }
      },
      {
        "node": {
          "title": "How to get the normal vector to a sideset( nodeset)?",
          "author": {
            "login": "Kavan-Khaledi"
          },
          "bodyText": "Dear MOOSE team,\nI am using the \"CoupledVarThresholdElementSubdomainModifier\" to simulate the boundary movement between two blocks. The velocity of the moving boundary (let's say V) is controlled by a coupled variable c (in my example: mass concentration). However, the direction of the movement should be perpendicular to the boundary. Therefore, the boundary-moving function should look something like this:\nX=X0+V(c)* t * [nx, ny, nz],\nwhere [nx, ny, nz] is the normal vector to the boundary at point (x,y,z) and time t.\nIs there a userobject or auxiliary variable in Moose that I can use to find the normal vector? If not, what is your advice?\nBest regards,\nKavan",
          "url": "https://github.com/idaholab/moose/discussions/22377",
          "updatedAt": "2022-10-22T00:02:06Z",
          "publishedAt": "2022-10-12T09:00:49Z",
          "category": {
            "name": "Q&A Modules: General"
          },
          "comments": {
            "edges": [
              {
                "node": {
                  "author": {
                    "login": "GiudGiud"
                  },
                  "bodyText": "hello\nYou can get the sides from the _current_elem (a class attribute to this user object), with a loop on the sides using this routine to retrieve them.\nhttps://libmesh.github.io/doxygen/classlibMesh_1_1Elem.html#a9c669d37f9a794d933bae07babc2eb60\nthen from these you can get the normal (with a cross product for example), once you've checked that the side is part of the boundary you care about with something like this for example:\nhttps://libmesh.github.io/doxygen/classlibMesh_1_1BoundaryInfo.html#a99bb67d6ae6c470d2cbfdb232dae609e\n(this one in particular uses the element and the side index, not the side element)\n\nGuillaume",
                  "url": "https://github.com/idaholab/moose/discussions/22377#discussioncomment-3863733",
                  "updatedAt": "2022-10-12T19:26:32Z",
                  "publishedAt": "2022-10-12T19:26:32Z",
                  "isAnswer": true,
                  "replies": {
                    "edges": []
                  }
                }
              }
            ]
          }
        }
      },
      {
        "node": {
          "title": "Looooong time for Setting Up",
          "author": {
            "login": "heinono1"
          },
          "bodyText": "I am running a fairly vanilla job using the Ferret app. No problems with reasonably large meshes (some 500k nodes). But when I try something more like a production-level mesh with 24M nodes and 18M tets, I run into problems. If I try to run --mesh-only to split the mesh, the execution chews on \"Setting Up\" for a long long time (timed out after 24 hrs on 96 MPI tasks). Same hppens if I run with --check-input. This is not a memory problem and I believe it is not specific to the app but rather something goofy in my framework build (all tests run fine, and I have no issues with small or medium sized problems). How can I figure out what gets the system hung up on \"Setting Up\"? It seems to me a mesh with some 24M nodes should not be a big deal if I have enough MPI tasks and memory to go around.\nThanks!",
          "url": "https://github.com/idaholab/moose/discussions/22358",
          "updatedAt": "2022-10-12T15:02:47Z",
          "publishedAt": "2022-10-10T22:30:15Z",
          "category": {
            "name": "Q&A General"
          },
          "comments": {
            "edges": [
              {
                "node": {
                  "author": {
                    "login": "friedmud"
                  },
                  "bodyText": "Are you getting any \"live prints\" coming out (something like \"Reading Mesh ......\")  You may want to try bumping up the output level of the PerfGraph to get more information printing out:\nhttps://mooseframework.inl.gov/source/outputs/PerfGraphOutput.html",
                  "url": "https://github.com/idaholab/moose/discussions/22358#discussioncomment-3843430",
                  "updatedAt": "2022-10-10T23:16:01Z",
                  "publishedAt": "2022-10-10T23:16:01Z",
                  "isAnswer": false,
                  "replies": {
                    "edges": [
                      {
                        "node": {
                          "author": {
                            "login": "hugary1995"
                          },
                          "bodyText": "There's also a script to help you find the culprit: https://github.com/idaholab/moose/blob/next/framework/scripts/find_hung_process.py\nIIRC this script assumes pbs, but it shouldn't be too hard to adapt it for slurm.",
                          "url": "https://github.com/idaholab/moose/discussions/22358#discussioncomment-3843452",
                          "updatedAt": "2022-10-10T23:22:40Z",
                          "publishedAt": "2022-10-10T23:20:15Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "Can you please paste your mesh block here as well please?",
                          "url": "https://github.com/idaholab/moose/discussions/22358#discussioncomment-3843635",
                          "updatedAt": "2022-10-11T00:07:38Z",
                          "publishedAt": "2022-10-11T00:07:38Z",
                          "isAnswer": false
                        }
                      }
                    ]
                  }
                }
              },
              {
                "node": {
                  "author": {
                    "login": "heinono1"
                  },
                  "bodyText": "Thanks, guys. I will try these things tomorrow, and also paste in the mesh\nblock.\n\nMartini-time now.\n\nCheers,\nOlle\n\u2026\nOn Mon, Oct 10, 2022, 7:07 PM Guillaume Giudicelli ***@***.***> wrote:\n Can you please paste your mesh block here as well please?\n\n \u2014\n Reply to this email directly, view it on GitHub\n <#22358 (reply in thread)>,\n or unsubscribe\n <https://github.com/notifications/unsubscribe-auth/AEKZEF7EICELJCDNO7D5U7TWCSVVJANCNFSM6AAAAAARBXHKFI>\n .\n You are receiving this because you authored the thread.Message ID:\n ***@***.***>",
                  "url": "https://github.com/idaholab/moose/discussions/22358#discussioncomment-3843709",
                  "updatedAt": "2022-10-11T00:28:54Z",
                  "publishedAt": "2022-10-11T00:28:53Z",
                  "isAnswer": false,
                  "replies": {
                    "edges": []
                  }
                }
              },
              {
                "node": {
                  "author": {
                    "login": "heinono1"
                  },
                  "bodyText": "Here is the mesh block:\n\n```\n  [Mesh]\n    [./testmesh]\n      type = FileMeshGenerator\n      file = Mb2_magpar_ferret_WP.inp\n    []\n    [./scale]\n      type = TransformGenerator\n      input = testmesh\n      transform = SCALE\n      vector_value = '1e3 1.e3 1.e3'\n    []\n  #  [./refine]\n  #      type = RefineBlockGenerator\n  #      input = scale\n  #      block = 'Volume51_TET4 Volume52_TET4'\n  #      refinement = '2 2'\n  #      enable_neighbor_refinement = true\n  #  []\n  []\n```\n\nOn Mon, Oct 10, 2022 at 7:28 PM Olle Heinonen ***@***.***>\nwrote:\n\u2026\n Thanks, guys. I will try these things tomorrow, and also paste in the mesh\n block.\n\n Martini-time now.\n\n Cheers,\n Olle\n\n On Mon, Oct 10, 2022, 7:07 PM Guillaume Giudicelli <\n ***@***.***> wrote:\n\n> Can you please paste your mesh block here as well please?\n>\n> \u2014\n> Reply to this email directly, view it on GitHub\n> <#22358 (reply in thread)>,\n> or unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/AEKZEF7EICELJCDNO7D5U7TWCSVVJANCNFSM6AAAAAARBXHKFI>\n> .\n> You are receiving this because you authored the thread.Message ID:\n> ***@***.***>\n>\n\n\n-- \nOlle Heinonen\n***@***.***",
                  "url": "https://github.com/idaholab/moose/discussions/22358#discussioncomment-3851096",
                  "updatedAt": "2022-10-11T14:22:04Z",
                  "publishedAt": "2022-10-11T14:18:06Z",
                  "isAnswer": false,
                  "replies": {
                    "edges": [
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "if you are using refinement could you please set this in the [Mesh] block\nskip_deletion_repartition_after_refine = true\nrepartitioning can take a long time in the setup",
                          "url": "https://github.com/idaholab/moose/discussions/22358#discussioncomment-3851161",
                          "updatedAt": "2022-10-11T14:24:09Z",
                          "publishedAt": "2022-10-11T14:24:09Z",
                          "isAnswer": false
                        }
                      }
                    ]
                  }
                }
              },
              {
                "node": {
                  "author": {
                    "login": "heinono1"
                  },
                  "bodyText": "OK, thanks. I'll try that.\n\u2026\nOn Tue, Oct 11, 2022 at 9:24 AM Guillaume Giudicelli < ***@***.***> wrote:\n if you are using refinement could you please set this in the [Mesh] block\n skip_deletion_repartition_after_refine = true\n\n repartitioning can take a long time in the setup\n\n \u2014\n Reply to this email directly, view it on GitHub\n <#22358 (reply in thread)>,\n or unsubscribe\n <https://github.com/notifications/unsubscribe-auth/AEKZEF2ZMPIOBKKMB27C2N3WCV2BJANCNFSM6AAAAAARBXHKFI>\n .\n You are receiving this because you authored the thread.Message ID:\n ***@***.***>\n\n\n-- \nOlle Heinonen\n***@***.***",
                  "url": "https://github.com/idaholab/moose/discussions/22358#discussioncomment-3851187",
                  "updatedAt": "2022-10-11T14:26:43Z",
                  "publishedAt": "2022-10-11T14:26:42Z",
                  "isAnswer": false,
                  "replies": {
                    "edges": []
                  }
                }
              },
              {
                "node": {
                  "author": {
                    "login": "heinono1"
                  },
                  "bodyText": "I get the usual banner page (for ferret in this case) that I am using\nferret. Then the code goes to\n \"Initializing simulation:\n\u2026\n________________________________________________________________________________________________\nSetting up........................\"\nand it keeps setting up. It does not hang - it keeps executing (adding more\ndots after \"Setting up\").\n\nIt seems like the problem with PerGraph output is that the simulation never\ncompletes \"Setting up\" (at least not in 24 hrs) so it does not get to a\nfirst evaluation of PerfGraph.\nOn Mon, Oct 10, 2022 at 6:16 PM Derek Gaston ***@***.***> wrote:\n Are you getting any \"live prints\" coming out (something like \"Reading Mesh\n ......\") You may want to try bumping up the output level of the PerfGraph\n to get more information printing out:\n\n https://mooseframework.inl.gov/source/outputs/PerfGraphOutput.html\n\n \u2014\n Reply to this email directly, view it on GitHub\n <#22358 (comment)>,\n or unsubscribe\n <https://github.com/notifications/unsubscribe-auth/AEKZEFZL6CCZ63L435QEMPLWCSPTXANCNFSM6AAAAAARBXHKFI>\n .\n You are receiving this because you authored the thread.Message ID:\n ***@***.***>\n\n\n-- \nOlle Heinonen\n***@***.***",
                  "url": "https://github.com/idaholab/moose/discussions/22358#discussioncomment-3851274",
                  "updatedAt": "2022-10-11T14:36:55Z",
                  "publishedAt": "2022-10-11T14:36:54Z",
                  "isAnswer": false,
                  "replies": {
                    "edges": []
                  }
                }
              },
              {
                "node": {
                  "author": {
                    "login": "heinono1"
                  },
                  "bodyText": "I am checking PerfGraphOutput for a smaller problem (some 500k nodes). I\nnote that FEProblem::projectSolution can take 270 s in one timestep, while\nFEProblem::solve takes 1 second (!). Does this make sense?\n\nOn Tue, Oct 11, 2022 at 9:36 AM Olle Heinonen ***@***.***>\nwrote:\n\u2026\n I get the usual banner page (for ferret in this case) that I am using\n ferret. Then the code goes to\n  \"Initializing simulation:\n\n ________________________________________________________________________________________________\n Setting up........................\"\n and it keeps setting up. It does not hang - it keeps executing (adding\n more dots after \"Setting up\").\n\n It seems like the problem with PerGraph output is that the simulation\n never completes \"Setting up\" (at least not in 24 hrs) so it does not get to\n a first evaluation of PerfGraph.\n\n On Mon, Oct 10, 2022 at 6:16 PM Derek Gaston ***@***.***>\n wrote:\n\n> Are you getting any \"live prints\" coming out (something like \"Reading\n> Mesh ......\") You may want to try bumping up the output level of the\n> PerfGraph to get more information printing out:\n>\n> https://mooseframework.inl.gov/source/outputs/PerfGraphOutput.html\n>\n> \u2014\n> Reply to this email directly, view it on GitHub\n> <#22358 (comment)>,\n> or unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/AEKZEFZL6CCZ63L435QEMPLWCSPTXANCNFSM6AAAAAARBXHKFI>\n> .\n> You are receiving this because you authored the thread.Message ID:\n> ***@***.***>\n>\n\n\n --\n Olle Heinonen\n ***@***.***\n\n\n-- \nOlle Heinonen\n***@***.***",
                  "url": "https://github.com/idaholab/moose/discussions/22358#discussioncomment-3851985",
                  "updatedAt": "2022-10-11T15:34:01Z",
                  "publishedAt": "2022-10-11T15:33:59Z",
                  "isAnswer": false,
                  "replies": {
                    "edges": []
                  }
                }
              },
              {
                "node": {
                  "author": {
                    "login": "heinono1"
                  },
                  "bodyText": "I did a more careful check using htop of what is going on. I ran this on my\nlinux workstation that has 96 GB of RAM. That should by all accounts work\nfor a 4 GB meshfile if I use distributed mesh on 24 MPI processes using\n--distributed-mesh, and also another run with\n --mesh-only --split-mesh 24\n in the command line. Monitoring the memory usage I noted that the MPI root\ntask was using up to about 10 GB while the other 23 tasks were using some\ninsignificant amount  of memory. But suddenly *all* tasks start to up their\nmemory usage (2 GB, 3GB, up towards 4 GB) and that causes the job to crash\nbecause it runs out of memory.\n\nThis suggests that there is something wrong (my install?) with how\ndistributing the mesh is being handled - it appears that in spite of the\n--split-mesh, all tasks are using up memory corresponding to the size of\nthe mesh file.\n\nAny ideas???\n\nOn Tue, Oct 11, 2022 at 10:33 AM Olle Heinonen ***@***.***>\nwrote:\n\u2026\n I am checking PerfGraphOutput for a smaller problem (some 500k nodes). I\n note that FEProblem::projectSolution can take 270 s in one timestep, while\n FEProblem::solve takes 1 second (!). Does this make sense?\n\n On Tue, Oct 11, 2022 at 9:36 AM Olle Heinonen ***@***.***>\n wrote:\n\n> I get the usual banner page (for ferret in this case) that I am using\n> ferret. Then the code goes to\n>  \"Initializing simulation:\n>\n> ________________________________________________________________________________________________\n> Setting up........................\"\n> and it keeps setting up. It does not hang - it keeps executing (adding\n> more dots after \"Setting up\").\n>\n> It seems like the problem with PerGraph output is that the simulation\n> never completes \"Setting up\" (at least not in 24 hrs) so it does not get to\n> a first evaluation of PerfGraph.\n>\n> On Mon, Oct 10, 2022 at 6:16 PM Derek Gaston ***@***.***>\n> wrote:\n>\n>> Are you getting any \"live prints\" coming out (something like \"Reading\n>> Mesh ......\") You may want to try bumping up the output level of the\n>> PerfGraph to get more information printing out:\n>>\n>> https://mooseframework.inl.gov/source/outputs/PerfGraphOutput.html\n>>\n>> \u2014\n>> Reply to this email directly, view it on GitHub\n>> <#22358 (comment)>,\n>> or unsubscribe\n>> <https://github.com/notifications/unsubscribe-auth/AEKZEFZL6CCZ63L435QEMPLWCSPTXANCNFSM6AAAAAARBXHKFI>\n>> .\n>> You are receiving this because you authored the thread.Message ID:\n>> ***@***.***>\n>>\n>\n>\n> --\n> Olle Heinonen\n> ***@***.***\n>\n\n\n --\n Olle Heinonen\n ***@***.***\n\n\n-- \nOlle Heinonen\n***@***.***",
                  "url": "https://github.com/idaholab/moose/discussions/22358#discussioncomment-3853254",
                  "updatedAt": "2022-10-11T18:02:21Z",
                  "publishedAt": "2022-10-11T18:02:19Z",
                  "isAnswer": false,
                  "replies": {
                    "edges": [
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "Can you paste your input file here?\nTypically this does not happen. We sometimes serialize the mesh on rank 0, never serialize it on all ranks starting from a distributed one",
                          "url": "https://github.com/idaholab/moose/discussions/22358#discussioncomment-3853288",
                          "updatedAt": "2022-10-11T18:08:03Z",
                          "publishedAt": "2022-10-11T18:08:03Z",
                          "isAnswer": false
                        }
                      }
                    ]
                  }
                }
              },
              {
                "node": {
                  "author": {
                    "login": "heinono1"
                  },
                  "bodyText": "Here it is\n\n```\n  ##############################\n  ##\n  ## UNITS:\n  ##\n  ##   gamma = (2.2101*10^5 / 2 pi) m/C\n  ##\n  ##   gamma/(mu*0Ms) = 48291.9 nm*mus/pg\n  ##\n  ##   coefficients given in (pg/nm*mus)\n  ##   which is equivalent to an energy/vol\n  ##\n  ##   Effective fields are 1/(mu0*Ms)*coeff\n  ##   which gives units of aC/(nm*mus)\n  ##\n  ##   Energies are natively printed in units\n  ##    of 0.160218 pg nm^2 / mus^2\n  ##    or 1.60218*10^{-22} J\n  ##    or 0.001 eV\n  ##\n  ##############################\n\n\n#Nx = 92\n#Ny = 22\n#Nz = 3\n\n#xMax = 500.0\n#yMax = 125.0\n#zMax = 3.0\n\nalphadef = 1.\n\n[Mesh]\n  [./testmesh]\n    type = FileMeshGenerator\n    file = Mb2_magpar_ferret_WP.inp\n  []\n  [./scale]\n    type = TransformGenerator\n    input = testmesh\n    transform = SCALE\n    vector_value = '1e3 1.e3 1.e3'\n  []\n#  [./refine]\n#      type = RefineBlockGenerator\n#      input = scale\n#      block = 'Volume51_TET4 Volume52_TET4'\n#      refinement = '2 2'\n#      enable_neighbor_refinement = true\n#  []\n[]\n\n\n[GlobalParams]\n  mag_x = mag_x\n  mag_y = mag_y\n  mag_z = mag_z\n\n  potential_H_int = potential_H_int\n[]\n\n[Materials]\n\n############################################################################\n  ##\n  ##       material constants used.\n  ##\n  ##34989.1\n\n############################################################################\n\n    [./WP]\n    type = GenericConstantMaterial\n    prop_names = ' alpha    K1 K2 nx ny nz       g0mu0Ms        g0\npermittivity Ae      Ms   mu0'\n    prop_values = '${alphadef} 6.6845e-04 0.  0 0 1.   27991.2    13995.6\n    1.0        13.0   -1.9  1.25664'\n    block = 'Volume25_TET4 Volume26_TET4'\n  [../]\n\n\n\n#NOTE: g0 is g*mu0*Ms/2 as defined by Hertel\n#alpha is chosen to be 1.0 as in the muMag paper\n\n  [./a_long]\n    type = GenericFunctionMaterial\n    prop_names = 'alpha_long'\n    prop_values = 'bc_func_1'\n    block = 'Volume1_TET4 Volume2_TET4 Volume3_TET4 Volume4_TET4\nVolume5_TET4 Volume6_TET4 Volume7_TET4 Volume8_TET4 Volume9_TET4\nVolume10_TET4 Volume11_TET4 Volume12_TET4 Volume13_TET4 Volume14_TET4\nVolume15_TET4 Volume16_TET4 Volume17_TET4 Volume18_TET4 Volume19_TET4\nVolume20_TET4 Volume21_TET4 Volume22_TET4 Volume23_TET4 Volume24_TET4\nVolume25_TET4 Volume26_TET4 Volume27_TET4 Volume28_TET4 Volume29_TET4\nVolume30_TET4 Volume31_TET4 Volume32_TET4 Volume37_TET4 Volume38_TET4'\n  [../]\n [./constantsv]\n    type = GenericConstantMaterial\n    prop_names = ' alpha  K1  nx ny nz         g0mu0Ms        g0\npermittivity Ae      Ms   mu0'\n    prop_values = '1   0.  0 0 1    27991.2    13995.6         1.0\n 13.0   .0  1.0'\n    block = ' Volume1_TET4 Volume2_TET4 Volume3_TET4 Volume4_TET4\nVolume5_TET4 Volume6_TET4 Volume7_TET4 Volume8_TET4 Volume9_TET4\nVolume10_TET4 Volume11_TET4 Volume12_TET4 Volume13_TET4 Volume14_TET4\nVolume15_TET4 Volume16_TET4 Volume17_TET4 Volume18_TET4 Volume19_TET4\nVolume20_TET4 Volume21_TET4 Volume22_TET4 Volume23_TET4 Volume24_TET4\nVolume27_TET4 Volume28_TET4 Volume29_TET4 Volume30_TET4 Volume31_TET4\nVolume32_TET4 Volume37_TET4 Volume38_TET4'\n  [../]\n  [./a_longv]\n    type = GenericFunctionMaterial\n    prop_names = 'alpha_long'\n    prop_values = 'bc_func_1'\n    block = ' Volume1_TET4 Volume2_TET4 Volume3_TET4 Volume4_TET4\nVolume5_TET4 Volume6_TET4 Volume7_TET4 Volume8_TET4 Volume9_TET4\nVolume10_TET4 Volume11_TET4 Volume12_TET4 Volume13_TET4 Volume14_TET4\nVolume15_TET4 Volume16_TET4 Volume17_TET4 Volume18_TET4 Volume19_TET4\nVolume20_TET4 Volume21_TET4 Volume22_TET4 Volume23_TET4 Volume24_TET4\nVolume27_TET4 Volume28_TET4 Volume29_TET4 Volume30_TET4 Volume31_TET4\nVolume32_TET4 Volume37_TET4 Volume38_TET4'\n  [../]\n\n[]\n\n[Functions]\n\n  ##############################\n  ##\n  ## Define the ramping function\n  ## expression to be used\n  ##\n  ##############################\n\n  [./bc_func_1]\n    type = ParsedFunction\n    value = 'st'\n    vars = 'st'\n    vals = '1.e0'  #3?\n  [../]\n\n[]\n\n[Variables]\n  [./mag_x]\n    order = FIRST\n    family = LAGRANGE\n    block = 'Volume25_TET4 Volume26_TET4'\n    [./InitialCondition]\n      type = RandomConstrainedVectorFieldIC\n      phi = azimuth_phi\n      theta = polar_theta\n      M0s = 1.0 #amplitude of the RandomConstrainedVectorFieldIC\n      component  = 0\n    [../]\n  [../]\n  [./mag_y]\n    order = FIRST\n    family = LAGRANGE\n    block = 'Volume25_TET4 Volume26_TET4'\n    [./InitialCondition]\n      type = RandomConstrainedVectorFieldIC\n      phi = azimuth_phi\n      theta = polar_theta\n      M0s = 1.0 #amplitude of the RandomConstrainedVectorFieldIC\n      component  = 1\n    [../]\n  [../]\n  [./mag_z]\n    order = FIRST\n    family = LAGRANGE\n    block='Volume25_TET4 Volume26_TET4'\n    [./InitialCondition]\n      type = RandomConstrainedVectorFieldIC\n      phi = azimuth_phi\n      theta = polar_theta\n      M0s = 1.0 #amplitude of the RandomConstrainedVectorFieldIC\n      component  = 2\n    [../]\n  [../]\n\n  [./potential_H_int]\n    order = FIRST\n    family = LAGRANGE\n    block = ' Volume1_TET4 Volume2_TET4 Volume3_TET4 Volume4_TET4\nVolume5_TET4 Volume6_TET4 Volume7_TET4 Volume8_TET4 Volume9_TET4\nVolume10_TET4 Volume11_TET4 Volume12_TET4 Volume13_TET4 Volume14_TET4\nVolume15_TET4 Volume16_TET4 Volume17_TET4 Volume18_TET4 Volume19_TET4\nVolume20_TET4 Volume21_TET4 Volume22_TET4 Volume23_TET4 Volume24_TET4\nVolume25_TET4 Volume26_TET4 Volume27_TET4 Volume28_TET4 Volume29_TET4\nVolume30_TET4 Volume31_TET4 Volume32_TET4 Volume37_TET4 Volume38_TET4'\n  [../]\n[]\n\n[AuxVariables]\n  #--------------------------------------------#\n  #                                            #\n  #  field to seed IC that obeys constraint    #\n  #                                            #\n  #--------------------------------------------#\n  [./azimuth_phi]\n    order = FIRST\n    family = LAGRANGE\n    block = 'Volume25_TET4 Volume26_TET4'\n    [./InitialCondition]\n      type = RandomIC\n      min = 0.\n      max = 0.1\n      seed = 2\n    [../]\n  [../]\n  [./polar_theta]\n    order = FIRST\n    family = LAGRANGE\n    block = 'Volume25_TET4 Volume26_TET4'\n    [./InitialCondition]\n      type = RandomIC\n      min = 0.01\n      max = 0.2\n      seed = 37\n    [../]\n  [../]\n  [./mag_s]\n    order = FIRST\n    family = LAGRANGE\n    block = 'Volume25_TET4 Volume26_TET4'\n  [../]\n\n[]\n\n\n[AuxKernels]\n  [./mag_mag]\n    type = VectorMag\n    variable = mag_s\n    vector_x = mag_x\n    vector_y = mag_y\n    vector_z = mag_z\n    execute_on = 'initial timestep_end final'\n    block = 'Volume25_TET4 Volume26_TET4'\n  [../]\n[]\n\n\n[Kernels]\n  #---------------------------------------#\n  #                                       #\n  #          Time dependence              #\n  #                                       #\n  #---------------------------------------#\n\n  [./mag_x_time]\n    type = TimeDerivative\n    variable = mag_x\n    block = 'Volume25_TET4 Volume26_TET4'\n  [../]\n  [./mag_y_time]\n    type = TimeDerivative\n    variable = mag_y\n    block = 'Volume25_TET4 Volume26_TET4'\n  [../]\n  [./mag_z_time]\n    type = TimeDerivative\n    variable = mag_z\n    block = 'Volume51_TET4 Volume52_TET'\n  [../]\n\n  #---------------------------------------#\n  #                                       #\n  #    Local magnetic exchange            #\n  #                                       #\n  #---------------------------------------#\n\n  [./dllg_x_exch]\n    type = ExchangeCartLL\n    variable = mag_x\n    component = 0\n    mag_x = mag_x\n    mag_y = mag_y\n    mag_z = mag_z\n    block = 'Volume25_TET4 Volume26_TET4'\n  [../]\n  [./dllg_y_exch]\n    type = ExchangeCartLL\n    variable = mag_y\n    component = 1\n    mag_x = mag_x\n    mag_y = mag_y\n    mag_z = mag_z\n    block = 'Volume25_TET4 Volume26_TET4'\n  [../]\n  [./dllg_z_exch]\n    type = ExchangeCartLL\n    variable = mag_z\n    component = 2\n    mag_x = mag_x\n    mag_y = mag_y\n    mag_z = mag_z\n    block = 'Volume25_TET4 Volume26_TET4'\n  [../]\n\n\n  #---------------------------------------#\n  #                                       #\n  #   Anisotropy\n  #                                       #\n  #---------------------------------------#\n\n  [./d_llg_d_mag_x_ani]\n    type = MasterAnisotropyCartLLG\n    variable = mag_x\n    component = 0\n    block = 'Volume25_TET4 Volume26_TET4'\n  [../]\n  [./d_llg_d_mag_y_ani]\n    type = MasterAnisotropyCartLLG\n    variable = mag_y\n    component = 1\n    block = 'Volume25_TET4 Volume26_TET4'\n  [../]\n   [./d_llg_d_mag_z_ani]\n    type = MasterAnisotropyCartLLG\n    variable = mag_z\n    component = 1\n    block = 'Volume25_TET4 Volume26_TET4'\n  [../]\n\n\n\n  #---------------------------------------#\n  #                                       #\n  #    demagnetization field              #\n  #                                       #\n  #---------------------------------------#\n\n  [./d_HM_x]\n    type = MasterInteractionCartLLGHConst\n    variable = mag_x\n    component = 0\n    Hext_x = Hext_x\n    Hext_y = Hext_y\n    Hext_z = Hext_z\n    block = 'Volume25_TET4 Volume26_TET4'\n  [../]\n  [./d_HM_y]\n    type = MasterInteractionCartLLGHConst\n    variable = mag_y\n    component = 1\n    Hext_x = Hext_x\n    Hext_y = Hext_y\n    Hext_z = Hext_z\n    block = 'Volume25_TET4 Volume26_TET4'\n  [../]\n  [./d_HM_z]\n    type = MasterInteractionCartLLGHConst\n    variable = mag_z\n    component = 2\n    Hext_x = Hext_x\n    Hext_y = Hext_y\n    Hext_z = Hext_z\n    block = 'Volume25_TET4 Volume26_TET4'\n  [../]\n\n  #---------------------------------------#\n  #                                       #\n  #          LLB constraint terms         #\n  #                                       #\n  #---------------------------------------#\n\n  [./llb1_x]\n    type = LongitudinalLLB\n    variable = mag_x\n    component = 0\n    block = 'Volume25_TET4 Volume26_TET4'\n  [../]\n  [./llb1_y]\n    type = LongitudinalLLB\n    variable = mag_y\n    component = 1\n    block = 'Volume25_TET4 Volume26_TET4'\n  [../]\n\n  [./llb1_z]\n    type = LongitudinalLLB\n    variable = mag_z\n    component = 2\n    block = 'Volume25_TET4 Volume26_TET4'\n  [../]\n\n  #---------------------------------------#\n  #                                       #\n  #    Magnetostatic Poisson equation     #\n  #                                       #\n  #---------------------------------------#\n\n  [./int_pot_lap]\n    type = Electrostatics\n    variable = potential_H_int\n    block = 'Volume25_TET4 Volume26_TET4 Volume1_TET4 Volume2_TET4\nVolume3_TET4 Volume4_TET4 Volume5_TET4 Volume6_TET4 Volume7_TET4\nVolume8_TET4 Volume9_TET4 Volume10_TET4 Volume11_TET4 Volume12_TET4\nVolume13_TET4 Volume14_TET4 Volume15_TET4 Volume16_TET4 Volume17_TET4\nVolume18_TET4 Volume19_TET4 Volume20_TET4 Volume21_TET4 Volume22_TET4\nVolume23_TET4 Volume24_TET4 Volume27_TET4 Volume28_TET4 Volume29_TET4\nVolume30_TET4 Volume31_TET4 Volume32_TET4 Volume37_TET4 Volume38_TET4'\n  [../]\n  [./int_bc_pot_lap]\n    type = MagHStrongCart\n    variable = potential_H_int\n    block = 'Volume25_TET4 Volume26_TET4'\n  [../]\n\n[]\n\n[BCs]\n  [./vacuum_box]\n    type = DirichletBC\n    value = 0.\n    variable = potential_H_int\n    boundary = 'Surface1 Surface2 Surface3 Surface4 Surface5 Surface6\nSurface7 Surface8 Surface9 Surface10 Surface11 Surface12 Surface13\nSurface14 Surface15 Surface17 Surface20 Surface21 Surface22 Surface23\nSurface24 Surface27 Surface28 Surface29 Surface30 Surface31 Surface32\nSurface33 Surface34 Surface35 Surface36 Surface37 Surface38'\n  [../]\n[]\n\n[Postprocessors]\n   [./dt]\n     type = TimestepSize\n   [../]\n\n  #---------------------------------------#\n  #                                       #\n  #     Average M = |m|                   #\n  #                                       #\n  #---------------------------------------#\n\n  [./M1]\n    type = ElementAverageValue\n    variable = mag_s\n    execute_on = 'initial timestep_end final'\n    block = 'Volume25_TET4 Volume26_TET4'\n  [../]\n\n  [./<mx>]\n    type = ElementAverageValue\n    variable = mag_x\n    execute_on = 'initial timestep_end final'\n    block = 'Volume25_TET4 Volume26_TET4'\n  [../]\n  [./<my>]\n    type = ElementAverageValue\n    variable = mag_y\n    execute_on = 'initial timestep_end final'\n    block = 'Volume25_TET4 Volume26_TET4'\n  [../]\n  [./<mz>]\n    type = ElementAverageValue\n    variable = mag_z\n    execute_on = 'initial timestep_end final'\n    block = 'Volume25_TET4 Volume26_TET4'\n  [../]\n\n  #---------------------------------------#\n  #                                       #\n  #   Calculate exchange energy of        #\n  #   the magnetic body                   #\n  #                                       #\n  #---------------------------------------#\n\n  [./Fexch]\n    type = MasterMagneticExchangeEnergy\n    energy_scale = 0.001  #converts results to eV\n    execute_on = 'initial timestep_end final'\n    block = 'Volume25_TET4 Volume26_TET4'\n  [../]\n\n  #---------------------------------------#\n  #                                       #\n  #   Calculate demagnetization energy    #\n  #   of the magnetic body                #\n  #                                       #\n  #---------------------------------------#\n\n  [./Fdemag]\n    type = MagnetostaticEnergyCart\n    energy_scale = 0.001  #converts results to eV\n    execute_on = 'initial timestep_end final'\n    block = 'Volume25_TET4 Volume26_TET4'\n  [../]\n[./Fani]\n    type = MasterMagneticAnisotropyEnergy\n    energy_scale = 0.001  #converts results to eV\n    execute_on = 'initial timestep_end final'\n    block = 'Volume25_TET4 Volume26_TET4'\n  [../]\n\n\n\n  #---------------------------------------#\n  #                                       #\n  #   Calculate excess energy from missed #\n  #   LLB targets                         #\n  #                                       #\n  #---------------------------------------#\n\n#  [./Fllb1]\n#    type = MagneticExcessLLBEnergy\n#    mag_x = mag_x\n#    mag_y = mag_y\n#    mag_z = mag_z\n#    execute_on = 'initial timestep_end final'\n#    block = 'Volume25_TET4 Volume26_TET4'\n#  [../]\n\n  #---------------------------------------#\n  #                                       #\n  #   add all the energy contributions    #\n  #   and calculate their percent change  #\n  #                                       #\n  #---------------------------------------#\n\n  [./Ftot]\n    type = LinearCombinationPostprocessor\n    pp_names = 'Fexch Fdemag Fani'\n    pp_coefs = ' 1.0 1.0 1.'\n    execute_on = 'initial timestep_end final'\n  [../]\n\n  [./perc_change]\n    type = EnergyRatePostprocessor\n    postprocessor = Ftot\n    dt = dt\n    execute_on = 'timestep_end final'\n  [../]\n\n  [./elapsed]\n    type = PerfGraphData\n    section_name = \"Root\"  # for profiling the problem\n    data_type = total\n  [../]\n[]\n\n[UserObjects]\n#  [./kill]\n#    type = Terminator\n#    expression = 'perc_change <= 1.0e-8'\n#  [../]\n  [mag]\n    type = RenormalizeVector\n    v = 'mag_x mag_y mag_z'\n    norm = 1\n    execute_on = 'TIMESTEP_END'\n#    force_praux = true\n  []\n#  [coil_field]\n#    type = PropertyReadFile\n#    prop_file_name = ../Hext.csv\n#    read_type = 'voronoi'\n#    nprop = 6 #number of columns in file\n#    nblock = 86 # number of blocks in mesh\n#    nvoronoi = 125000\n#    #use_random_voronoi = true\n#  []\n[]\n\n[Preconditioning]\n\n  #---------------------------------------#\n  #                                       #\n  #            Solver options             #\n  #                                       #\n  #---------------------------------------#\n\n  [./smp]\n    type = SMP\n    full = true\n    petsc_options_iname = ' -ksp_gmres_restart -snes_atol -snes_rtol\n-ksp_rtol -pc_type '\n    petsc_options_value = '    40               1e-12      1e-5      1e-5\n  bjacobi'\n#    petsc_options_iname = '-pc_type -ksp_gmres_restart -sub_ksp_type\n-sub_pc_type -pc_asm_overlap'\n#    petsc_options_value = 'asm   31   preonly   ilu   4'\n#    petsc_options_iname = '-pc_type -pc_hypre_type\n-pc_hypre_boomeramg_strong_threshold -pc_hypre_boomeramg_max_levels\n-pc_hypre_boomeramg_coarsen_type -pc_hypre_boomeramg_agg_nl\n-pc_hypre_boomeramg_agg_num_paths -pc_hypre_boomeramg_interp_type\n-pc_hypre_boomeramg_P_max -pc_hypre_boomeramg_truncfactor'\n#    petsc_options_value = 'hypre boomeramg  0.7 25 HMIS  4 5 ext+i 2 0.3'\n\n\n  [../]\n[]\n\n[Executioner]\n  type = Transient\n  solve_type = 'NEWTON'\n#  scheme = 'BDF2'\n#  num_grids = 8\n  line_search = 'none' #or 'bt'\n  automatic_scaling = true\n\n  [./TimeIntegrator]\n    type = NewmarkBeta #LStableDirk4 #NewmarkBeta\n  [../]\n\n  dtmin = 1.e-10\n  dtmax = 4.e-5\n  nl_rel_tol = 1.e-6\n  l_max_its = 1000\n\n  [./TimeStepper]\n    type = IterationAdaptiveDT\n    optimal_iterations = 15 #25  #usually 10\n    linear_iteration_ratio = 1000\n    dt = 1e-6\n    growth_factor = 1.1\n    cutback_factor = 0.75\n#   type = AB2PredictorCorrector\n#    e_max =  5.e-1\n#    e_tol =   5.e-1\n#    growth_factor = 1.1\n\n  [../]\n  num_steps = 12000\n[../]\n\n#[Adaptivity]\n#   marker = combo\n#    max_h_level = 2\n#    [./Markers]\n#      [./EFM_1]\n#        type = ErrorFractionMarker\n#        coarsen = 0.1\n#        refine = 0.9\n#        indicator = GJI_1\n#      [../]\n#      [./EFM_2]\n#        type = ErrorFractionMarker\n#        coarsen = 0.1\n#        refine = 0.9\n#        indicator = GJI_2\n#      [../]\n#      [./EFM_3]\n#        type = ErrorFractionMarker\n#        coarsen = 0.1\n#        refine = 0.9\n#        indicator = GJI_3\n#      [../]\n#      [./combo]\n#        type = ComboMarker\n#        markers = 'EFM_1 EFM_2 EFM_3'\n#      [../]\n#    [../]\n#\n#    [./Indicators]\n#      [./GJI_1]\n#        type=GradientJumpIndicator\n#        variable = mag_x\n#      [../]\n#     [./GJI_2]\n#        type=GradientJumpIndicator\n#        variable = mag_y\n#      [../]\n#     [./GJI_3]\n#        type=GradientJumpIndicator\n#        variable = mag_z\n#      [../]\n#    [../]\n#[]\n#    interval = 1\n#    refine_fraction = 0.4\n#    coarsen_fraction = 0.4\n#    max_h_level = 3\n#  [../]\n\n\n[Outputs]\n  print_linear_residuals = false\n  [./checkpoint]\n    type = Checkpoint\n    interval = 30\n    num_files = 2\n  [../]\n  [./out]\n    type = Nemesis #Exodus\n    file_base = wtest1\n    elemental_as_nodal = true\n    interval = 30\n  [../]\n  [./outCSV]\n    type = CSV\n    file_base = wtest1\n    interval = 30\n  [../]\n[]\n\n```\n\u2026\nOn Tue, Oct 11, 2022 at 1:08 PM Guillaume Giudicelli < ***@***.***> wrote:\n Can you paste your input file here?\n Typically this does not happen. We sometimes serialize the mesh on rank 0,\n never serialize it on all ranks starting from a distributed one\n\n \u2014\n Reply to this email directly, view it on GitHub\n <#22358 (reply in thread)>,\n or unsubscribe\n <https://github.com/notifications/unsubscribe-auth/AEKZEF3RQNGT6DQYVZ6SMRLWCWUI3ANCNFSM6AAAAAARBXHKFI>\n .\n You are receiving this because you authored the thread.Message ID:\n ***@***.***>\n\n\n-- \nOlle Heinonen\n***@***.***",
                  "url": "https://github.com/idaholab/moose/discussions/22358#discussioncomment-3853304",
                  "updatedAt": "2022-10-11T21:18:21Z",
                  "publishedAt": "2022-10-11T18:10:47Z",
                  "isAnswer": false,
                  "replies": {
                    "edges": []
                  }
                }
              },
              {
                "node": {
                  "author": {
                    "login": "mangerij"
                  },
                  "bodyText": "Following along here, this should be current with Ferret master.\n\nI've seen this in other Ferret problems (polar-elastic) when I scale to big dof as well... don't think it's a Ferret specific problem but I suggest to try this with a Nemesis mesh if you are not using AMR.\n\nGet Outlook for Android<https://aka.ms/AAb9ysg>\n\u2026\n________________________________\nFrom: Olle Heinonen ***@***.***>\nSent: Tuesday, October 11, 2022 2:11:01 PM\nTo: idaholab/moose ***@***.***>\nCc: Subscribed ***@***.***>\nSubject: Re: [idaholab/moose] Looooong time for Setting Up (Discussion #22358)\n\n\n*Message sent from a system outside of UConn.*\n\n\nHere it is\n\n\n##############################\n##\n## UNITS:\n##\n## gamma = (2.2101*10^5 / 2 pi) m/C\n##\n## gamma/(mu*0Ms) = 48291.9 nm*mus/pg\n##\n## coefficients given in (pg/nm*mus)\n## which is equivalent to an energy/vol\n##\n## Effective fields are 1/(mu0*Ms)*coeff\n## which gives units of aC/(nm*mus)\n##\n## Energies are natively printed in units\n## of 0.160218 pg nm^2 / mus^2\n## or 1.60218*10^{-22} J\n## or 0.001 eV\n##\n##############################\n\n\n#Nx = 92\n#Ny = 22\n#Nz = 3\n\n#xMax = 500.0\n#yMax = 125.0\n#zMax = 3.0\n\nalphadef = 1.\n\n[Mesh]\n[./testmesh]\ntype = FileMeshGenerator\nfile = Mb2_magpar_ferret_WP.inp\n[]\n[./scale]\ntype = TransformGenerator\ninput = testmesh\ntransform = SCALE\nvector_value = '1e3 1.e3 1.e3'\n[]\n# [./refine]\n# type = RefineBlockGenerator\n# input = scale\n# block = 'Volume51_TET4 Volume52_TET4'\n# refinement = '2 2'\n# enable_neighbor_refinement = true\n# []\n[]\n\n\n[GlobalParams]\nmag_x = mag_x\nmag_y = mag_y\nmag_z = mag_z\n\npotential_H_int = potential_H_int\n[]\n\n[Materials]\n\n############################################################################\n##\n## material constants used.\n##\n##34989.1\n\n############################################################################\n\n[./WP]\ntype = GenericConstantMaterial\nprop_names = ' alpha K1 K2 nx ny nz g0mu0Ms g0\npermittivity Ae Ms mu0'\nprop_values = '${alphadef} 6.6845e-04 0. 0 0 1. 27991.2 13995.6\n1.0 13.0 -1.9 1.25664'\nblock = 'Volume25_TET4 Volume26_TET4'\n[../]\n\n\n\n#NOTE: g0 is g*mu0*Ms/2 as defined by Hertel\n#alpha is chosen to be 1.0 as in the muMag paper\n\n[./a_long]\ntype = GenericFunctionMaterial\nprop_names = 'alpha_long'\nprop_values = 'bc_func_1'\nblock = 'Volume1_TET4 Volume2_TET4 Volume3_TET4 Volume4_TET4\nVolume5_TET4 Volume6_TET4 Volume7_TET4 Volume8_TET4 Volume9_TET4\nVolume10_TET4 Volume11_TET4 Volume12_TET4 Volume13_TET4 Volume14_TET4\nVolume15_TET4 Volume16_TET4 Volume17_TET4 Volume18_TET4 Volume19_TET4\nVolume20_TET4 Volume21_TET4 Volume22_TET4 Volume23_TET4 Volume24_TET4\nVolume25_TET4 Volume26_TET4 Volume27_TET4 Volume28_TET4 Volume29_TET4\nVolume30_TET4 Volume31_TET4 Volume32_TET4 Volume37_TET4 Volume38_TET4'\n[../]\n[./constantsv]\ntype = GenericConstantMaterial\nprop_names = ' alpha K1 nx ny nz g0mu0Ms g0\npermittivity Ae Ms mu0'\nprop_values = '1 0. 0 0 1 27991.2 13995.6 1.0\n13.0 .0 1.0'\nblock = ' Volume1_TET4 Volume2_TET4 Volume3_TET4 Volume4_TET4\nVolume5_TET4 Volume6_TET4 Volume7_TET4 Volume8_TET4 Volume9_TET4\nVolume10_TET4 Volume11_TET4 Volume12_TET4 Volume13_TET4 Volume14_TET4\nVolume15_TET4 Volume16_TET4 Volume17_TET4 Volume18_TET4 Volume19_TET4\nVolume20_TET4 Volume21_TET4 Volume22_TET4 Volume23_TET4 Volume24_TET4\nVolume27_TET4 Volume28_TET4 Volume29_TET4 Volume30_TET4 Volume31_TET4\nVolume32_TET4 Volume37_TET4 Volume38_TET4'\n[../]\n[./a_longv]\ntype = GenericFunctionMaterial\nprop_names = 'alpha_long'\nprop_values = 'bc_func_1'\nblock = ' Volume1_TET4 Volume2_TET4 Volume3_TET4 Volume4_TET4\nVolume5_TET4 Volume6_TET4 Volume7_TET4 Volume8_TET4 Volume9_TET4\nVolume10_TET4 Volume11_TET4 Volume12_TET4 Volume13_TET4 Volume14_TET4\nVolume15_TET4 Volume16_TET4 Volume17_TET4 Volume18_TET4 Volume19_TET4\nVolume20_TET4 Volume21_TET4 Volume22_TET4 Volume23_TET4 Volume24_TET4\nVolume27_TET4 Volume28_TET4 Volume29_TET4 Volume30_TET4 Volume31_TET4\nVolume32_TET4 Volume37_TET4 Volume38_TET4'\n[../]\n\n[]\n\n[Functions]\n\n##############################\n##\n## Define the ramping function\n## expression to be used\n##\n##############################\n\n[./bc_func_1]\ntype = ParsedFunction\nvalue = 'st'\nvars = 'st'\nvals = '1.e0' #3?\n[../]\n\n[]\n\n[Variables]\n[./mag_x]\norder = FIRST\nfamily = LAGRANGE\nblock = 'Volume25_TET4 Volume26_TET4'\n[./InitialCondition]\ntype = RandomConstrainedVectorFieldIC\nphi = azimuth_phi\ntheta = polar_theta\nM0s = 1.0 #amplitude of the RandomConstrainedVectorFieldIC\ncomponent = 0\n[../]\n[../]\n[./mag_y]\norder = FIRST\nfamily = LAGRANGE\nblock = 'Volume25_TET4 Volume26_TET4'\n[./InitialCondition]\ntype = RandomConstrainedVectorFieldIC\nphi = azimuth_phi\ntheta = polar_theta\nM0s = 1.0 #amplitude of the RandomConstrainedVectorFieldIC\ncomponent = 1\n[../]\n[../]\n[./mag_z]\norder = FIRST\nfamily = LAGRANGE\nblock='Volume25_TET4 Volume26_TET4'\n[./InitialCondition]\ntype = RandomConstrainedVectorFieldIC\nphi = azimuth_phi\ntheta = polar_theta\nM0s = 1.0 #amplitude of the RandomConstrainedVectorFieldIC\ncomponent = 2\n[../]\n[../]\n\n[./potential_H_int]\norder = FIRST\nfamily = LAGRANGE\nblock = ' Volume1_TET4 Volume2_TET4 Volume3_TET4 Volume4_TET4\nVolume5_TET4 Volume6_TET4 Volume7_TET4 Volume8_TET4 Volume9_TET4\nVolume10_TET4 Volume11_TET4 Volume12_TET4 Volume13_TET4 Volume14_TET4\nVolume15_TET4 Volume16_TET4 Volume17_TET4 Volume18_TET4 Volume19_TET4\nVolume20_TET4 Volume21_TET4 Volume22_TET4 Volume23_TET4 Volume24_TET4\nVolume25_TET4 Volume26_TET4 Volume27_TET4 Volume28_TET4 Volume29_TET4\nVolume30_TET4 Volume31_TET4 Volume32_TET4 Volume37_TET4 Volume38_TET4'\n[../]\n[]\n\n[AuxVariables]\n#--------------------------------------------#\n# #\n# field to seed IC that obeys constraint #\n# #\n#--------------------------------------------#\n[./azimuth_phi]\norder = FIRST\nfamily = LAGRANGE\nblock = 'Volume25_TET4 Volume26_TET4'\n[./InitialCondition]\ntype = RandomIC\nmin = 0.\nmax = 0.1\nseed = 2\n[../]\n[../]\n[./polar_theta]\norder = FIRST\nfamily = LAGRANGE\nblock = 'Volume25_TET4 Volume26_TET4'\n[./InitialCondition]\ntype = RandomIC\nmin = 0.01\nmax = 0.2\nseed = 37\n[../]\n[../]\n[./mag_s]\norder = FIRST\nfamily = LAGRANGE\nblock = 'Volume25_TET4 Volume26_TET4'\n[../]\n\n[]\n\n\n[AuxKernels]\n[./mag_mag]\ntype = VectorMag\nvariable = mag_s\nvector_x = mag_x\nvector_y = mag_y\nvector_z = mag_z\nexecute_on = 'initial timestep_end final'\nblock = 'Volume25_TET4 Volume26_TET4'\n[../]\n[]\n\n\n[Kernels]\n#---------------------------------------#\n# #\n# Time dependence #\n# #\n#---------------------------------------#\n\n[./mag_x_time]\ntype = TimeDerivative\nvariable = mag_x\nblock = 'Volume25_TET4 Volume26_TET4'\n[../]\n[./mag_y_time]\ntype = TimeDerivative\nvariable = mag_y\nblock = 'Volume25_TET4 Volume26_TET4'\n[../]\n[./mag_z_time]\ntype = TimeDerivative\nvariable = mag_z\nblock = 'Volume51_TET4 Volume52_TET'\n[../]\n\n#---------------------------------------#\n# #\n# Local magnetic exchange #\n# #\n#---------------------------------------#\n\n[./dllg_x_exch]\ntype = ExchangeCartLL\nvariable = mag_x\ncomponent = 0\nmag_x = mag_x\nmag_y = mag_y\nmag_z = mag_z\nblock = 'Volume25_TET4 Volume26_TET4'\n[../]\n[./dllg_y_exch]\ntype = ExchangeCartLL\nvariable = mag_y\ncomponent = 1\nmag_x = mag_x\nmag_y = mag_y\nmag_z = mag_z\nblock = 'Volume25_TET4 Volume26_TET4'\n[../]\n[./dllg_z_exch]\ntype = ExchangeCartLL\nvariable = mag_z\ncomponent = 2\nmag_x = mag_x\nmag_y = mag_y\nmag_z = mag_z\nblock = 'Volume25_TET4 Volume26_TET4'\n[../]\n\n\n#---------------------------------------#\n# #\n# Anisotropy\n# #\n#---------------------------------------#\n\n[./d_llg_d_mag_x_ani]\ntype = MasterAnisotropyCartLLG\nvariable = mag_x\ncomponent = 0\nblock = 'Volume25_TET4 Volume26_TET4'\n[../]\n[./d_llg_d_mag_y_ani]\ntype = MasterAnisotropyCartLLG\nvariable = mag_y\ncomponent = 1\nblock = 'Volume25_TET4 Volume26_TET4'\n[../]\n[./d_llg_d_mag_z_ani]\ntype = MasterAnisotropyCartLLG\nvariable = mag_z\ncomponent = 1\nblock = 'Volume25_TET4 Volume26_TET4'\n[../]\n\n\n\n#---------------------------------------#\n# #\n# demagnetization field #\n# #\n#---------------------------------------#\n\n[./d_HM_x]\ntype = MasterInteractionCartLLGHConst\nvariable = mag_x\ncomponent = 0\nHext_x = Hext_x\nHext_y = Hext_y\nHext_z = Hext_z\nblock = 'Volume25_TET4 Volume26_TET4'\n[../]\n[./d_HM_y]\ntype = MasterInteractionCartLLGHConst\nvariable = mag_y\ncomponent = 1\nHext_x = Hext_x\nHext_y = Hext_y\nHext_z = Hext_z\nblock = 'Volume25_TET4 Volume26_TET4'\n[../]\n[./d_HM_z]\ntype = MasterInteractionCartLLGHConst\nvariable = mag_z\ncomponent = 2\nHext_x = Hext_x\nHext_y = Hext_y\nHext_z = Hext_z\nblock = 'Volume25_TET4 Volume26_TET4'\n[../]\n\n#---------------------------------------#\n# #\n# LLB constraint terms #\n# #\n#---------------------------------------#\n\n[./llb1_x]\ntype = LongitudinalLLB\nvariable = mag_x\ncomponent = 0\nblock = 'Volume25_TET4 Volume26_TET4'\n[../]\n[./llb1_y]\ntype = LongitudinalLLB\nvariable = mag_y\ncomponent = 1\nblock = 'Volume25_TET4 Volume26_TET4'\n[../]\n\n[./llb1_z]\ntype = LongitudinalLLB\nvariable = mag_z\ncomponent = 2\nblock = 'Volume25_TET4 Volume26_TET4'\n[../]\n\n#---------------------------------------#\n# #\n# Magnetostatic Poisson equation #\n# #\n#---------------------------------------#\n\n[./int_pot_lap]\ntype = Electrostatics\nvariable = potential_H_int\nblock = 'Volume25_TET4 Volume26_TET4 Volume1_TET4 Volume2_TET4\nVolume3_TET4 Volume4_TET4 Volume5_TET4 Volume6_TET4 Volume7_TET4\nVolume8_TET4 Volume9_TET4 Volume10_TET4 Volume11_TET4 Volume12_TET4\nVolume13_TET4 Volume14_TET4 Volume15_TET4 Volume16_TET4 Volume17_TET4\nVolume18_TET4 Volume19_TET4 Volume20_TET4 Volume21_TET4 Volume22_TET4\nVolume23_TET4 Volume24_TET4 Volume27_TET4 Volume28_TET4 Volume29_TET4\nVolume30_TET4 Volume31_TET4 Volume32_TET4 Volume37_TET4 Volume38_TET4'\n[../]\n[./int_bc_pot_lap]\ntype = MagHStrongCart\nvariable = potential_H_int\nblock = 'Volume25_TET4 Volume26_TET4'\n[../]\n\n[]\n\n[BCs]\n[./vacuum_box]\ntype = DirichletBC\nvalue = 0.\nvariable = potential_H_int\nboundary = 'Surface1 Surface2 Surface3 Surface4 Surface5 Surface6\nSurface7 Surface8 Surface9 Surface10 Surface11 Surface12 Surface13\nSurface14 Surface15 Surface17 Surface20 Surface21 Surface22 Surface23\nSurface24 Surface27 Surface28 Surface29 Surface30 Surface31 Surface32\nSurface33 Surface34 Surface35 Surface36 Surface37 Surface38'\n[../]\n[]\n\n[Postprocessors]\n[./dt]\ntype = TimestepSize\n[../]\n\n#---------------------------------------#\n# #\n# Average M = |m| #\n# #\n#---------------------------------------#\n\n[./M1]\ntype = ElementAverageValue\nvariable = mag_s\nexecute_on = 'initial timestep_end final'\nblock = 'Volume25_TET4 Volume26_TET4'\n[../]\n\n[./<mx>]\ntype = ElementAverageValue\nvariable = mag_x\nexecute_on = 'initial timestep_end final'\nblock = 'Volume25_TET4 Volume26_TET4'\n[../]\n[./<my>]\ntype = ElementAverageValue\nvariable = mag_y\nexecute_on = 'initial timestep_end final'\nblock = 'Volume25_TET4 Volume26_TET4'\n[../]\n[./<mz>]\ntype = ElementAverageValue\nvariable = mag_z\nexecute_on = 'initial timestep_end final'\nblock = 'Volume25_TET4 Volume26_TET4'\n[../]\n\n#---------------------------------------#\n# #\n# Calculate exchange energy of #\n# the magnetic body #\n# #\n#---------------------------------------#\n\n[./Fexch]\ntype = MasterMagneticExchangeEnergy\nenergy_scale = 0.001 #converts results to eV\nexecute_on = 'initial timestep_end final'\nblock = 'Volume25_TET4 Volume26_TET4'\n[../]\n\n#---------------------------------------#\n# #\n# Calculate demagnetization energy #\n# of the magnetic body #\n# #\n#---------------------------------------#\n\n[./Fdemag]\ntype = MagnetostaticEnergyCart\nenergy_scale = 0.001 #converts results to eV\nexecute_on = 'initial timestep_end final'\nblock = 'Volume25_TET4 Volume26_TET4'\n[../]\n[./Fani]\ntype = MasterMagneticAnisotropyEnergy\nenergy_scale = 0.001 #converts results to eV\nexecute_on = 'initial timestep_end final'\nblock = 'Volume25_TET4 Volume26_TET4'\n[../]\n\n\n\n#---------------------------------------#\n# #\n# Calculate excess energy from missed #\n# LLB targets #\n# #\n#---------------------------------------#\n\n# [./Fllb1]\n# type = MagneticExcessLLBEnergy\n# mag_x = mag_x\n# mag_y = mag_y\n# mag_z = mag_z\n# execute_on = 'initial timestep_end final'\n# block = 'Volume25_TET4 Volume26_TET4'\n# [../]\n\n#---------------------------------------#\n# #\n# add all the energy contributions #\n# and calculate their percent change #\n# #\n#---------------------------------------#\n\n[./Ftot]\ntype = LinearCombinationPostprocessor\npp_names = 'Fexch Fdemag Fani'\npp_coefs = ' 1.0 1.0 1.'\nexecute_on = 'initial timestep_end final'\n[../]\n\n[./perc_change]\ntype = EnergyRatePostprocessor\npostprocessor = Ftot\ndt = dt\nexecute_on = 'timestep_end final'\n[../]\n\n[./elapsed]\ntype = PerfGraphData\nsection_name = \"Root\" # for profiling the problem\ndata_type = total\n[../]\n[]\n\n[UserObjects]\n# [./kill]\n# type = Terminator\n# expression = 'perc_change <= 1.0e-8'\n# [../]\n[mag]\ntype = RenormalizeVector\nv = 'mag_x mag_y mag_z'\nnorm = 1\nexecute_on = 'TIMESTEP_END'\n# force_praux = true\n[]\n# [coil_field]\n# type = PropertyReadFile\n# prop_file_name = ../Hext.csv\n# read_type = 'voronoi'\n# nprop = 6 #number of columns in file\n# nblock = 86 # number of blocks in mesh\n# nvoronoi = 125000\n# #use_random_voronoi = true\n# []\n[]\n\n[Preconditioning]\n\n#---------------------------------------#\n# #\n# Solver options #\n# #\n#---------------------------------------#\n\n[./smp]\ntype = SMP\nfull = true\npetsc_options_iname = ' -ksp_gmres_restart -snes_atol -snes_rtol\n-ksp_rtol -pc_type '\npetsc_options_value = ' 40 1e-12 1e-5 1e-5\nbjacobi'\n# petsc_options_iname = '-pc_type -ksp_gmres_restart -sub_ksp_type\n-sub_pc_type -pc_asm_overlap'\n# petsc_options_value = 'asm 31 preonly ilu 4'\n# petsc_options_iname = '-pc_type -pc_hypre_type\n-pc_hypre_boomeramg_strong_threshold -pc_hypre_boomeramg_max_levels\n-pc_hypre_boomeramg_coarsen_type -pc_hypre_boomeramg_agg_nl\n-pc_hypre_boomeramg_agg_num_paths -pc_hypre_boomeramg_interp_type\n-pc_hypre_boomeramg_P_max -pc_hypre_boomeramg_truncfactor'\n# petsc_options_value = 'hypre boomeramg 0.7 25 HMIS 4 5 ext+i 2 0.3'\n\n\n[../]\n[]\n\n[Executioner]\ntype = Transient\nsolve_type = 'NEWTON'\n# scheme = 'BDF2'\n# num_grids = 8\nline_search = 'none' #or 'bt'\nautomatic_scaling = true\n\n[./TimeIntegrator]\ntype = NewmarkBeta #LStableDirk4 #NewmarkBeta\n[../]\n\ndtmin = 1.e-10\ndtmax = 4.e-5\nnl_rel_tol = 1.e-6\nl_max_its = 1000\n\n[./TimeStepper]\ntype = IterationAdaptiveDT\noptimal_iterations = 15 #25 #usually 10\nlinear_iteration_ratio = 1000\ndt = 1e-6\ngrowth_factor = 1.1\ncutback_factor = 0.75\n# type = AB2PredictorCorrector\n# e_max = 5.e-1\n# e_tol = 5.e-1\n# growth_factor = 1.1\n\n[../]\nnum_steps = 12000\n[../]\n\n#[Adaptivity]\n# marker = combo\n# max_h_level = 2\n# [./Markers]\n# [./EFM_1]\n# type = ErrorFractionMarker\n# coarsen = 0.1\n# refine = 0.9\n# indicator = GJI_1\n# [../]\n# [./EFM_2]\n# type = ErrorFractionMarker\n# coarsen = 0.1\n# refine = 0.9\n# indicator = GJI_2\n# [../]\n# [./EFM_3]\n# type = ErrorFractionMarker\n# coarsen = 0.1\n# refine = 0.9\n# indicator = GJI_3\n# [../]\n# [./combo]\n# type = ComboMarker\n# markers = 'EFM_1 EFM_2 EFM_3'\n# [../]\n# [../]\n#\n# [./Indicators]\n# [./GJI_1]\n# type=GradientJumpIndicator\n# variable = mag_x\n# [../]\n# [./GJI_2]\n# type=GradientJumpIndicator\n# variable = mag_y\n# [../]\n# [./GJI_3]\n# type=GradientJumpIndicator\n# variable = mag_z\n# [../]\n# [../]\n#[]\n# interval = 1\n# refine_fraction = 0.4\n# coarsen_fraction = 0.4\n# max_h_level = 3\n# [../]\n\n\n[Outputs]\nprint_linear_residuals = false\n[./checkpoint]\ntype = Checkpoint\ninterval = 30\nnum_files = 2\n[../]\n[./out]\ntype = Nemesis #Exodus\nfile_base = wtest1\nelemental_as_nodal = true\ninterval = 30\n[../]\n[./outCSV]\ntype = CSV\nfile_base = wtest1\ninterval = 30\n[../]\n[]\nOn Tue, Oct 11, 2022 at 1:08 PM Guillaume Giudicelli < ***@***.***> wrote:\n Can you paste your input file here?\n Typically this does not happen. We sometimes serialize the mesh on rank 0,\n never serialize it on all ranks starting from a distributed one\n\n \u2014\n Reply to this email directly, view it on GitHub\n <#22358 (reply in thread)>,\n or unsubscribe\n <https://github.com/notifications/unsubscribe-auth/AEKZEF3RQNGT6DQYVZ6SMRLWCWUI3ANCNFSM6AAAAAARBXHKFI>\n .\n You are receiving this because you authored the thread.Message ID:\n ***@***.***>\n\n\n--\nOlle Heinonen\n***@***.***\n\n\u2014\nReply to this email directly, view it on GitHub<https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2Fidaholab%2Fmoose%2Fdiscussions%2F22358%23discussioncomment-3853304&data=05%7C01%7C%7C63690c2456ea4f09e21308daabb3f53c%7C17f1a87e2a254eaab9df9d439034b080%7C0%7C0%7C638011086648821233%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=LZUpzabyy3TxpZ8DfbyKZdl99%2B4A1784%2Bu9epNIDeK4%3D&reserved=0>, or unsubscribe<https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2Fnotifications%2Funsubscribe-auth%2FABZ65FHL52ANFRDRJWEOH2DWCWUTLANCNFSM6AAAAAARBXHKFI&data=05%7C01%7C%7C63690c2456ea4f09e21308daabb3f53c%7C17f1a87e2a254eaab9df9d439034b080%7C0%7C0%7C638011086648821233%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=NCOVMESa8KZLye9jh4RiE4QXTiUgTuQRlOzaXsLHEKs%3D&reserved=0>.\nYou are receiving this because you are subscribed to this thread.Message ID: ***@***.***>",
                  "url": "https://github.com/idaholab/moose/discussions/22358#discussioncomment-3853353",
                  "updatedAt": "2022-10-11T18:18:45Z",
                  "publishedAt": "2022-10-11T18:18:44Z",
                  "isAnswer": false,
                  "replies": {
                    "edges": []
                  }
                }
              },
              {
                "node": {
                  "author": {
                    "login": "heinono1"
                  },
                  "bodyText": "Thanks, John. Changing to Nemesis output did not change anything - same\nrun-away of memory per task, and then the simulation runs out of memory and\ncrashes\n\u2026\nOn Tue, Oct 11, 2022 at 1:18 PM John ***@***.***> wrote:\n Following along here, this should be current with Ferret master.\n\n I've seen this in other Ferret problems (polar-elastic) when I scale to\n big dof as well... don't think it's a Ferret specific problem but I suggest\n to try this with a Nemesis mesh if you are not using AMR.\n\n Get Outlook for Android<https://aka.ms/AAb9ysg>\n ________________________________\n From: Olle Heinonen ***@***.***>\n Sent: Tuesday, October 11, 2022 2:11:01 PM\n To: idaholab/moose ***@***.***>\n Cc: Subscribed ***@***.***>\n Subject: Re: [idaholab/moose] Looooong time for Setting Up (Discussion\n #22358)\n\n\n *Message sent from a system outside of UConn.*\n\n\n Here it is\n\n\n ##############################\n ##\n ## UNITS:\n ##\n ## gamma = (2.2101*10^5 / 2 pi) m/C\n ##\n ## gamma/(mu*0Ms) = 48291.9 nm*mus/pg\n ##\n ## coefficients given in (pg/nm*mus)\n ## which is equivalent to an energy/vol\n ##\n ## Effective fields are 1/(mu0*Ms)*coeff\n ## which gives units of aC/(nm*mus)\n ##\n ## Energies are natively printed in units\n ## of 0.160218 pg nm^2 / mus^2\n ## or 1.60218*10^{-22} J\n ## or 0.001 eV\n ##\n ##############################\n\n\n #Nx = 92\n #Ny = 22\n #Nz = 3\n\n #xMax = 500.0\n #yMax = 125.0\n #zMax = 3.0\n\n alphadef = 1.\n\n [Mesh]\n [./testmesh]\n type = FileMeshGenerator\n file = Mb2_magpar_ferret_WP.inp\n []\n [./scale]\n type = TransformGenerator\n input = testmesh\n transform = SCALE\n vector_value = '1e3 1.e3 1.e3'\n []\n # [./refine]\n # type = RefineBlockGenerator\n # input = scale\n # block = 'Volume51_TET4 Volume52_TET4'\n # refinement = '2 2'\n # enable_neighbor_refinement = true\n # []\n []\n\n\n [GlobalParams]\n mag_x = mag_x\n mag_y = mag_y\n mag_z = mag_z\n\n potential_H_int = potential_H_int\n []\n\n [Materials]\n\n\n ############################################################################\n ##\n ## material constants used.\n ##\n ##34989.1\n\n\n ############################################################################\n\n [./WP]\n type = GenericConstantMaterial\n prop_names = ' alpha K1 K2 nx ny nz g0mu0Ms g0\n permittivity Ae Ms mu0'\n prop_values = '${alphadef} 6.6845e-04 0. 0 0 1. 27991.2 13995.6\n 1.0 13.0 -1.9 1.25664'\n block = 'Volume25_TET4 Volume26_TET4'\n [../]\n\n\n\n #NOTE: g0 is g*mu0*Ms/2 as defined by Hertel\n #alpha is chosen to be 1.0 as in the muMag paper\n\n [./a_long]\n type = GenericFunctionMaterial\n prop_names = 'alpha_long'\n prop_values = 'bc_func_1'\n block = 'Volume1_TET4 Volume2_TET4 Volume3_TET4 Volume4_TET4\n Volume5_TET4 Volume6_TET4 Volume7_TET4 Volume8_TET4 Volume9_TET4\n Volume10_TET4 Volume11_TET4 Volume12_TET4 Volume13_TET4 Volume14_TET4\n Volume15_TET4 Volume16_TET4 Volume17_TET4 Volume18_TET4 Volume19_TET4\n Volume20_TET4 Volume21_TET4 Volume22_TET4 Volume23_TET4 Volume24_TET4\n Volume25_TET4 Volume26_TET4 Volume27_TET4 Volume28_TET4 Volume29_TET4\n Volume30_TET4 Volume31_TET4 Volume32_TET4 Volume37_TET4 Volume38_TET4'\n [../]\n [./constantsv]\n type = GenericConstantMaterial\n prop_names = ' alpha K1 nx ny nz g0mu0Ms g0\n permittivity Ae Ms mu0'\n prop_values = '1 0. 0 0 1 27991.2 13995.6 1.0\n 13.0 .0 1.0'\n block = ' Volume1_TET4 Volume2_TET4 Volume3_TET4 Volume4_TET4\n Volume5_TET4 Volume6_TET4 Volume7_TET4 Volume8_TET4 Volume9_TET4\n Volume10_TET4 Volume11_TET4 Volume12_TET4 Volume13_TET4 Volume14_TET4\n Volume15_TET4 Volume16_TET4 Volume17_TET4 Volume18_TET4 Volume19_TET4\n Volume20_TET4 Volume21_TET4 Volume22_TET4 Volume23_TET4 Volume24_TET4\n Volume27_TET4 Volume28_TET4 Volume29_TET4 Volume30_TET4 Volume31_TET4\n Volume32_TET4 Volume37_TET4 Volume38_TET4'\n [../]\n [./a_longv]\n type = GenericFunctionMaterial\n prop_names = 'alpha_long'\n prop_values = 'bc_func_1'\n block = ' Volume1_TET4 Volume2_TET4 Volume3_TET4 Volume4_TET4\n Volume5_TET4 Volume6_TET4 Volume7_TET4 Volume8_TET4 Volume9_TET4\n Volume10_TET4 Volume11_TET4 Volume12_TET4 Volume13_TET4 Volume14_TET4\n Volume15_TET4 Volume16_TET4 Volume17_TET4 Volume18_TET4 Volume19_TET4\n Volume20_TET4 Volume21_TET4 Volume22_TET4 Volume23_TET4 Volume24_TET4\n Volume27_TET4 Volume28_TET4 Volume29_TET4 Volume30_TET4 Volume31_TET4\n Volume32_TET4 Volume37_TET4 Volume38_TET4'\n [../]\n\n []\n\n [Functions]\n\n ##############################\n ##\n ## Define the ramping function\n ## expression to be used\n ##\n ##############################\n\n [./bc_func_1]\n type = ParsedFunction\n value = 'st'\n vars = 'st'\n vals = '1.e0' #3?\n [../]\n\n []\n\n [Variables]\n [./mag_x]\n order = FIRST\n family = LAGRANGE\n block = 'Volume25_TET4 Volume26_TET4'\n [./InitialCondition]\n type = RandomConstrainedVectorFieldIC\n phi = azimuth_phi\n theta = polar_theta\n M0s = 1.0 #amplitude of the RandomConstrainedVectorFieldIC\n component = 0\n [../]\n [../]\n [./mag_y]\n order = FIRST\n family = LAGRANGE\n block = 'Volume25_TET4 Volume26_TET4'\n [./InitialCondition]\n type = RandomConstrainedVectorFieldIC\n phi = azimuth_phi\n theta = polar_theta\n M0s = 1.0 #amplitude of the RandomConstrainedVectorFieldIC\n component = 1\n [../]\n [../]\n [./mag_z]\n order = FIRST\n family = LAGRANGE\n block='Volume25_TET4 Volume26_TET4'\n [./InitialCondition]\n type = RandomConstrainedVectorFieldIC\n phi = azimuth_phi\n theta = polar_theta\n M0s = 1.0 #amplitude of the RandomConstrainedVectorFieldIC\n component = 2\n [../]\n [../]\n\n [./potential_H_int]\n order = FIRST\n family = LAGRANGE\n block = ' Volume1_TET4 Volume2_TET4 Volume3_TET4 Volume4_TET4\n Volume5_TET4 Volume6_TET4 Volume7_TET4 Volume8_TET4 Volume9_TET4\n Volume10_TET4 Volume11_TET4 Volume12_TET4 Volume13_TET4 Volume14_TET4\n Volume15_TET4 Volume16_TET4 Volume17_TET4 Volume18_TET4 Volume19_TET4\n Volume20_TET4 Volume21_TET4 Volume22_TET4 Volume23_TET4 Volume24_TET4\n Volume25_TET4 Volume26_TET4 Volume27_TET4 Volume28_TET4 Volume29_TET4\n Volume30_TET4 Volume31_TET4 Volume32_TET4 Volume37_TET4 Volume38_TET4'\n [../]\n []\n\n [AuxVariables]\n #--------------------------------------------#\n # #\n # field to seed IC that obeys constraint #\n # #\n #--------------------------------------------#\n [./azimuth_phi]\n order = FIRST\n family = LAGRANGE\n block = 'Volume25_TET4 Volume26_TET4'\n [./InitialCondition]\n type = RandomIC\n min = 0.\n max = 0.1\n seed = 2\n [../]\n [../]\n [./polar_theta]\n order = FIRST\n family = LAGRANGE\n block = 'Volume25_TET4 Volume26_TET4'\n [./InitialCondition]\n type = RandomIC\n min = 0.01\n max = 0.2\n seed = 37\n [../]\n [../]\n [./mag_s]\n order = FIRST\n family = LAGRANGE\n block = 'Volume25_TET4 Volume26_TET4'\n [../]\n\n []\n\n\n [AuxKernels]\n [./mag_mag]\n type = VectorMag\n variable = mag_s\n vector_x = mag_x\n vector_y = mag_y\n vector_z = mag_z\n execute_on = 'initial timestep_end final'\n block = 'Volume25_TET4 Volume26_TET4'\n [../]\n []\n\n\n [Kernels]\n #---------------------------------------#\n # #\n # Time dependence #\n # #\n #---------------------------------------#\n\n [./mag_x_time]\n type = TimeDerivative\n variable = mag_x\n block = 'Volume25_TET4 Volume26_TET4'\n [../]\n [./mag_y_time]\n type = TimeDerivative\n variable = mag_y\n block = 'Volume25_TET4 Volume26_TET4'\n [../]\n [./mag_z_time]\n type = TimeDerivative\n variable = mag_z\n block = 'Volume51_TET4 Volume52_TET'\n [../]\n\n #---------------------------------------#\n # #\n # Local magnetic exchange #\n # #\n #---------------------------------------#\n\n [./dllg_x_exch]\n type = ExchangeCartLL\n variable = mag_x\n component = 0\n mag_x = mag_x\n mag_y = mag_y\n mag_z = mag_z\n block = 'Volume25_TET4 Volume26_TET4'\n [../]\n [./dllg_y_exch]\n type = ExchangeCartLL\n variable = mag_y\n component = 1\n mag_x = mag_x\n mag_y = mag_y\n mag_z = mag_z\n block = 'Volume25_TET4 Volume26_TET4'\n [../]\n [./dllg_z_exch]\n type = ExchangeCartLL\n variable = mag_z\n component = 2\n mag_x = mag_x\n mag_y = mag_y\n mag_z = mag_z\n block = 'Volume25_TET4 Volume26_TET4'\n [../]\n\n\n #---------------------------------------#\n # #\n # Anisotropy\n # #\n #---------------------------------------#\n\n [./d_llg_d_mag_x_ani]\n type = MasterAnisotropyCartLLG\n variable = mag_x\n component = 0\n block = 'Volume25_TET4 Volume26_TET4'\n [../]\n [./d_llg_d_mag_y_ani]\n type = MasterAnisotropyCartLLG\n variable = mag_y\n component = 1\n block = 'Volume25_TET4 Volume26_TET4'\n [../]\n [./d_llg_d_mag_z_ani]\n type = MasterAnisotropyCartLLG\n variable = mag_z\n component = 1\n block = 'Volume25_TET4 Volume26_TET4'\n [../]\n\n\n\n #---------------------------------------#\n # #\n # demagnetization field #\n # #\n #---------------------------------------#\n\n [./d_HM_x]\n type = MasterInteractionCartLLGHConst\n variable = mag_x\n component = 0\n Hext_x = Hext_x\n Hext_y = Hext_y\n Hext_z = Hext_z\n block = 'Volume25_TET4 Volume26_TET4'\n [../]\n [./d_HM_y]\n type = MasterInteractionCartLLGHConst\n variable = mag_y\n component = 1\n Hext_x = Hext_x\n Hext_y = Hext_y\n Hext_z = Hext_z\n block = 'Volume25_TET4 Volume26_TET4'\n [../]\n [./d_HM_z]\n type = MasterInteractionCartLLGHConst\n variable = mag_z\n component = 2\n Hext_x = Hext_x\n Hext_y = Hext_y\n Hext_z = Hext_z\n block = 'Volume25_TET4 Volume26_TET4'\n [../]\n\n #---------------------------------------#\n # #\n # LLB constraint terms #\n # #\n #---------------------------------------#\n\n [./llb1_x]\n type = LongitudinalLLB\n variable = mag_x\n component = 0\n block = 'Volume25_TET4 Volume26_TET4'\n [../]\n [./llb1_y]\n type = LongitudinalLLB\n variable = mag_y\n component = 1\n block = 'Volume25_TET4 Volume26_TET4'\n [../]\n\n [./llb1_z]\n type = LongitudinalLLB\n variable = mag_z\n component = 2\n block = 'Volume25_TET4 Volume26_TET4'\n [../]\n\n #---------------------------------------#\n # #\n # Magnetostatic Poisson equation #\n # #\n #---------------------------------------#\n\n [./int_pot_lap]\n type = Electrostatics\n variable = potential_H_int\n block = 'Volume25_TET4 Volume26_TET4 Volume1_TET4 Volume2_TET4\n Volume3_TET4 Volume4_TET4 Volume5_TET4 Volume6_TET4 Volume7_TET4\n Volume8_TET4 Volume9_TET4 Volume10_TET4 Volume11_TET4 Volume12_TET4\n Volume13_TET4 Volume14_TET4 Volume15_TET4 Volume16_TET4 Volume17_TET4\n Volume18_TET4 Volume19_TET4 Volume20_TET4 Volume21_TET4 Volume22_TET4\n Volume23_TET4 Volume24_TET4 Volume27_TET4 Volume28_TET4 Volume29_TET4\n Volume30_TET4 Volume31_TET4 Volume32_TET4 Volume37_TET4 Volume38_TET4'\n [../]\n [./int_bc_pot_lap]\n type = MagHStrongCart\n variable = potential_H_int\n block = 'Volume25_TET4 Volume26_TET4'\n [../]\n\n []\n\n [BCs]\n [./vacuum_box]\n type = DirichletBC\n value = 0.\n variable = potential_H_int\n boundary = 'Surface1 Surface2 Surface3 Surface4 Surface5 Surface6\n Surface7 Surface8 Surface9 Surface10 Surface11 Surface12 Surface13\n Surface14 Surface15 Surface17 Surface20 Surface21 Surface22 Surface23\n Surface24 Surface27 Surface28 Surface29 Surface30 Surface31 Surface32\n Surface33 Surface34 Surface35 Surface36 Surface37 Surface38'\n [../]\n []\n\n [Postprocessors]\n [./dt]\n type = TimestepSize\n [../]\n\n #---------------------------------------#\n # #\n # Average M = |m| #\n # #\n #---------------------------------------#\n\n [./M1]\n type = ElementAverageValue\n variable = mag_s\n execute_on = 'initial timestep_end final'\n block = 'Volume25_TET4 Volume26_TET4'\n [../]\n\n [./<mx>]\n type = ElementAverageValue\n variable = mag_x\n execute_on = 'initial timestep_end final'\n block = 'Volume25_TET4 Volume26_TET4'\n [../]\n [./<my>]\n type = ElementAverageValue\n variable = mag_y\n execute_on = 'initial timestep_end final'\n block = 'Volume25_TET4 Volume26_TET4'\n [../]\n [./<mz>]\n type = ElementAverageValue\n variable = mag_z\n execute_on = 'initial timestep_end final'\n block = 'Volume25_TET4 Volume26_TET4'\n [../]\n\n #---------------------------------------#\n # #\n # Calculate exchange energy of #\n # the magnetic body #\n # #\n #---------------------------------------#\n\n [./Fexch]\n type = MasterMagneticExchangeEnergy\n energy_scale = 0.001 #converts results to eV\n execute_on = 'initial timestep_end final'\n block = 'Volume25_TET4 Volume26_TET4'\n [../]\n\n #---------------------------------------#\n # #\n # Calculate demagnetization energy #\n # of the magnetic body #\n # #\n #---------------------------------------#\n\n [./Fdemag]\n type = MagnetostaticEnergyCart\n energy_scale = 0.001 #converts results to eV\n execute_on = 'initial timestep_end final'\n block = 'Volume25_TET4 Volume26_TET4'\n [../]\n [./Fani]\n type = MasterMagneticAnisotropyEnergy\n energy_scale = 0.001 #converts results to eV\n execute_on = 'initial timestep_end final'\n block = 'Volume25_TET4 Volume26_TET4'\n [../]\n\n\n\n #---------------------------------------#\n # #\n # Calculate excess energy from missed #\n # LLB targets #\n # #\n #---------------------------------------#\n\n # [./Fllb1]\n # type = MagneticExcessLLBEnergy\n # mag_x = mag_x\n # mag_y = mag_y\n # mag_z = mag_z\n # execute_on = 'initial timestep_end final'\n # block = 'Volume25_TET4 Volume26_TET4'\n # [../]\n\n #---------------------------------------#\n # #\n # add all the energy contributions #\n # and calculate their percent change #\n # #\n #---------------------------------------#\n\n [./Ftot]\n type = LinearCombinationPostprocessor\n pp_names = 'Fexch Fdemag Fani'\n pp_coefs = ' 1.0 1.0 1.'\n execute_on = 'initial timestep_end final'\n [../]\n\n [./perc_change]\n type = EnergyRatePostprocessor\n postprocessor = Ftot\n dt = dt\n execute_on = 'timestep_end final'\n [../]\n\n [./elapsed]\n type = PerfGraphData\n section_name = \"Root\" # for profiling the problem\n data_type = total\n [../]\n []\n\n [UserObjects]\n # [./kill]\n # type = Terminator\n # expression = 'perc_change <= 1.0e-8'\n # [../]\n [mag]\n type = RenormalizeVector\n v = 'mag_x mag_y mag_z'\n norm = 1\n execute_on = 'TIMESTEP_END'\n # force_praux = true\n []\n # [coil_field]\n # type = PropertyReadFile\n # prop_file_name = ../Hext.csv\n # read_type = 'voronoi'\n # nprop = 6 #number of columns in file\n # nblock = 86 # number of blocks in mesh\n # nvoronoi = 125000\n # #use_random_voronoi = true\n # []\n []\n\n [Preconditioning]\n\n #---------------------------------------#\n # #\n # Solver options #\n # #\n #---------------------------------------#\n\n [./smp]\n type = SMP\n full = true\n petsc_options_iname = ' -ksp_gmres_restart -snes_atol -snes_rtol\n -ksp_rtol -pc_type '\n petsc_options_value = ' 40 1e-12 1e-5 1e-5\n bjacobi'\n # petsc_options_iname = '-pc_type -ksp_gmres_restart -sub_ksp_type\n -sub_pc_type -pc_asm_overlap'\n # petsc_options_value = 'asm 31 preonly ilu 4'\n # petsc_options_iname = '-pc_type -pc_hypre_type\n -pc_hypre_boomeramg_strong_threshold -pc_hypre_boomeramg_max_levels\n -pc_hypre_boomeramg_coarsen_type -pc_hypre_boomeramg_agg_nl\n -pc_hypre_boomeramg_agg_num_paths -pc_hypre_boomeramg_interp_type\n -pc_hypre_boomeramg_P_max -pc_hypre_boomeramg_truncfactor'\n # petsc_options_value = 'hypre boomeramg 0.7 25 HMIS 4 5 ext+i 2 0.3'\n\n\n [../]\n []\n\n [Executioner]\n type = Transient\n solve_type = 'NEWTON'\n # scheme = 'BDF2'\n # num_grids = 8\n line_search = 'none' #or 'bt'\n automatic_scaling = true\n\n [./TimeIntegrator]\n type = NewmarkBeta #LStableDirk4 #NewmarkBeta\n [../]\n\n dtmin = 1.e-10\n dtmax = 4.e-5\n nl_rel_tol = 1.e-6\n l_max_its = 1000\n\n [./TimeStepper]\n type = IterationAdaptiveDT\n optimal_iterations = 15 #25 #usually 10\n linear_iteration_ratio = 1000\n dt = 1e-6\n growth_factor = 1.1\n cutback_factor = 0.75\n # type = AB2PredictorCorrector\n # e_max = 5.e-1\n # e_tol = 5.e-1\n # growth_factor = 1.1\n\n [../]\n num_steps = 12000\n [../]\n\n #[Adaptivity]\n # marker = combo\n # max_h_level = 2\n # [./Markers]\n # [./EFM_1]\n # type = ErrorFractionMarker\n # coarsen = 0.1\n # refine = 0.9\n # indicator = GJI_1\n # [../]\n # [./EFM_2]\n # type = ErrorFractionMarker\n # coarsen = 0.1\n # refine = 0.9\n # indicator = GJI_2\n # [../]\n # [./EFM_3]\n # type = ErrorFractionMarker\n # coarsen = 0.1\n # refine = 0.9\n # indicator = GJI_3\n # [../]\n # [./combo]\n # type = ComboMarker\n # markers = 'EFM_1 EFM_2 EFM_3'\n # [../]\n # [../]\n #\n # [./Indicators]\n # [./GJI_1]\n # type=GradientJumpIndicator\n # variable = mag_x\n # [../]\n # [./GJI_2]\n # type=GradientJumpIndicator\n # variable = mag_y\n # [../]\n # [./GJI_3]\n # type=GradientJumpIndicator\n # variable = mag_z\n # [../]\n # [../]\n #[]\n # interval = 1\n # refine_fraction = 0.4\n # coarsen_fraction = 0.4\n # max_h_level = 3\n # [../]\n\n\n [Outputs]\n print_linear_residuals = false\n [./checkpoint]\n type = Checkpoint\n interval = 30\n num_files = 2\n [../]\n [./out]\n type = Nemesis #Exodus\n file_base = wtest1\n elemental_as_nodal = true\n interval = 30\n [../]\n [./outCSV]\n type = CSV\n file_base = wtest1\n interval = 30\n [../]\n []\n\n On Tue, Oct 11, 2022 at 1:08 PM Guillaume Giudicelli <\n ***@***.***> wrote:\n\n > Can you paste your input file here?\n > Typically this does not happen. We sometimes serialize the mesh on rank\n 0,\n > never serialize it on all ranks starting from a distributed one\n >\n > \u2014\n > Reply to this email directly, view it on GitHub\n > <\n #22358 (reply in thread)\n >,\n > or unsubscribe\n > <\n https://github.com/notifications/unsubscribe-auth/AEKZEF3RQNGT6DQYVZ6SMRLWCWUI3ANCNFSM6AAAAAARBXHKFI\n >\n > .\n > You are receiving this because you authored the thread.Message ID:\n > ***@***.***>\n >\n\n\n --\n Olle Heinonen\n ***@***.***\n\n \u2014\n Reply to this email directly, view it on GitHub<\n https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2Fidaholab%2Fmoose%2Fdiscussions%2F22358%23discussioncomment-3853304&data=05%7C01%7C%7C63690c2456ea4f09e21308daabb3f53c%7C17f1a87e2a254eaab9df9d439034b080%7C0%7C0%7C638011086648821233%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=LZUpzabyy3TxpZ8DfbyKZdl99%2B4A1784%2Bu9epNIDeK4%3D&reserved=0>,\n or unsubscribe<\n https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2Fnotifications%2Funsubscribe-auth%2FABZ65FHL52ANFRDRJWEOH2DWCWUTLANCNFSM6AAAAAARBXHKFI&data=05%7C01%7C%7C63690c2456ea4f09e21308daabb3f53c%7C17f1a87e2a254eaab9df9d439034b080%7C0%7C0%7C638011086648821233%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=NCOVMESa8KZLye9jh4RiE4QXTiUgTuQRlOzaXsLHEKs%3D&reserved=0\n >.\n You are receiving this because you are subscribed to this thread.Message\n ID: ***@***.***>\n\n \u2014\n Reply to this email directly, view it on GitHub\n <#22358 (comment)>,\n or unsubscribe\n <https://github.com/notifications/unsubscribe-auth/AEKZEF35NKJSTEUP6CATPXLWCWVQ7ANCNFSM6AAAAAARBXHKFI>\n .\n You are receiving this because you authored the thread.Message ID:\n ***@***.***>\n\n\n-- \nOlle Heinonen\n***@***.***",
                  "url": "https://github.com/idaholab/moose/discussions/22358#discussioncomment-3853406",
                  "updatedAt": "2022-10-11T18:25:04Z",
                  "publishedAt": "2022-10-11T18:25:03Z",
                  "isAnswer": false,
                  "replies": {
                    "edges": []
                  }
                }
              }
            ]
          }
        }
      },
      {
        "node": {
          "title": "Wanna learn to use ADKernelSUPG for application development",
          "author": {
            "login": "Raven-pro"
          },
          "bodyText": "Hello everyone!\nI am using MOOSE to build an application to simulate the transient single-phase flow using three basic equations and several state equations, and now it comes to the final part.\nIn the transient simulation, the oscillation happens near the boundary, leading to not converging at certain time step. So I am trying to use some stablization methods like SUPG used in the NS module.\nThen I look into the NS kernels, finding that there is a basic kernel called ADKernelSUPG which is the base class of many ns kernels, so I am trying to make use of the Kernel to compute the stablization terms.\nHowever, I cannot find tutorial on how to use this kernel for development on the offical website. Could you help me with learning to use ADKernelSUPG and Kernels like that? Like examples or docs and things like that.\nThank you so much!",
          "url": "https://github.com/idaholab/moose/discussions/22341",
          "updatedAt": "2022-10-12T14:29:13Z",
          "publishedAt": "2022-10-09T17:07:56Z",
          "category": {
            "name": "Q&A General"
          },
          "comments": {
            "edges": [
              {
                "node": {
                  "author": {
                    "login": "GiudGiud"
                  },
                  "bodyText": "Hello\nI'm afraid the actual development of the NS module, especially the INSAD implementation, is not documented beyond the doxygen\nhttps://mooseframework.inl.gov/docs/doxygen/moose/classADKernelSUPGTempl.html\nand the modules FE description\nhttps://mooseframework.inl.gov/modules/navier_stokes/cgfe.html\n@lindsayad do you know of any more SUPG documentation out there?\nBefore you attempt to use SUPG, have you made sure your implementation is correct? By doing verification & validation on simple cases? see this post #22344 for details on verification\nGuillaume",
                  "url": "https://github.com/idaholab/moose/discussions/22341#discussioncomment-3839975",
                  "updatedAt": "2022-10-10T14:29:36Z",
                  "publishedAt": "2022-10-10T14:29:35Z",
                  "isAnswer": false,
                  "replies": {
                    "edges": []
                  }
                }
              },
              {
                "node": {
                  "author": {
                    "login": "lindsayad"
                  },
                  "bodyText": "The only class in MOOSE that inherits directly from ADKernelSUPG (the scalar field form) is INSADEnergySUPG. I think that doc page, although short, is helpful. Essentially you need to do 3 things:\n\nprovide a material property describing tau\nprovide a vector variable velocity\nimplement precomputeQpStrongResidual. You could do this on a strong term basis, e.g. if you have three terms in your PDE, create three kernels that inherit from ADKernelSUPG. Or you could do something like what is done in INSADEnergySUPG where only one kernel is used to gather the contributions from all terms in the PDE (those contributions are held in a material property _temperature_strong_residual)\n\nStrong term/strong form just means your PDE before you convert it to the weak form for finite element discretization.",
                  "url": "https://github.com/idaholab/moose/discussions/22341#discussioncomment-3841895",
                  "updatedAt": "2022-10-10T18:30:41Z",
                  "publishedAt": "2022-10-10T18:30:41Z",
                  "isAnswer": true,
                  "replies": {
                    "edges": [
                      {
                        "node": {
                          "author": {
                            "login": "Raven-pro"
                          },
                          "bodyText": "Thanks for your reply!\nI will try on it  :)",
                          "url": "https://github.com/idaholab/moose/discussions/22341#discussioncomment-3861202",
                          "updatedAt": "2022-10-12T14:29:13Z",
                          "publishedAt": "2022-10-12T14:29:13Z",
                          "isAnswer": false
                        }
                      }
                    ]
                  }
                }
              }
            ]
          }
        }
      },
      {
        "node": {
          "title": "Results changed by slightly adjust executioner block",
          "author": {
            "login": "Traiwit"
          },
          "bodyText": "Hi guys, so i'm running a simple porousflow simulation for mining application by increasing permeability at the middle part (cave) the model for each SS run consecutively ie frame1 > frame2 > frame3, now we only look at how the phreatic surface (pwp =0) move for each frame, it's supposed to be bigger as frame progress.\nlets say here is frame1 this is the result and its [Executioner]\n[Executioner]\ntype = Steady\nsolve_type = NEWTON\npetsc_options = '-snes_converged_reason'\npetsc_options_iname = '-pc_type -pc_hypre_type'\npetsc_options_value = 'hypre    boomeramg '\nnl_rel_tol = 1e-14\nnl_abs_tol = 2e2\nl_tol = 1e-06\nl_max_its = 100\nnl_max_its = 100\nline_search = 'none' \n[]\n\n\nThe result is as expected\nso the next frame (frame2_v1), I used the result of frame1 as the initial condition and ran with the same [Executioner]\nthis is what i got\n\nit seems to be smaller, which is incorrect\nthen I changed the [Executioner] to\n[Executioner]\ntype = Steady\nsolve_type = NEWTON\npetsc_options = '-snes_converged_reason'\npetsc_options_iname = '-pc_type -pc_hypre_type'\npetsc_options_value = 'hypre    boomeramg '\nnl_rel_tol = 1e-14\nnl_abs_tol = 2e2\nl_tol = 1e-06\nl_max_its = 100\nnl_max_its = 100\nline_search = 'bt' \n[]\n\nand I got the expected results (frame2_v2)\n\nidk why this is the case, sometimes I increase nl_abs_tol = 2e2 to 3e2 re-run and it changes the way my simulation run > more non-linear steps etc, there is something that isn't so stable.\nmore findings when comparing the darcy_vel\nframe1\n\nframe2_v1 (obviously looks really bad)\n\nframe2_v2 (back to normal)\n\nso the [Executioner] is the only control factor of my results, note that, all cases are converged around the same residual\nnote: only\npetsc_options_iname = '-pc_type -pc_hypre_type'\npetsc_options_value = 'hypre    boomeramg \n\nworks with my workflow, the models are huge and complex, we have tried other solvers, but they wouldn't work.\nPlease let me know if you have any idea\nKind regards,\nTraiwit",
          "url": "https://github.com/idaholab/moose/discussions/22102",
          "updatedAt": "2022-10-12T14:21:39Z",
          "publishedAt": "2022-09-15T03:24:29Z",
          "category": {
            "name": "Q&A General"
          },
          "comments": {
            "edges": [
              {
                "node": {
                  "author": {
                    "login": "GiudGiud"
                  },
                  "bodyText": "2e2 for the absolute residual seems huge, the relative tolerance is fine but probably doesnt matter with such a large residual criterion\nCould you please turn on automatic_scaling = true\nthen try to make sure every variable is sufficiently converged.\nThere s show_var_residual_norms in the [Debug] block you may use for that",
                  "url": "https://github.com/idaholab/moose/discussions/22102#discussioncomment-3650168",
                  "updatedAt": "2022-09-15T04:16:05Z",
                  "publishedAt": "2022-09-15T04:16:04Z",
                  "isAnswer": true,
                  "replies": {
                    "edges": [
                      {
                        "node": {
                          "author": {
                            "login": "Traiwit"
                          },
                          "bodyText": "Hi @GiudGiud, the first nonlinear step is ~e16 so it's down like 1e-14 already\nnot sure if automatic_scaling = true would do anything since there is only 1 variable in the system (porepressure)\ni got show_var_residual_norms on, most of the frames go like this, I couldn't tell from here if the result will be bad or not unless i check on paraview\n\n0 Nonlinear |R| = 1.199015e+16\n\n    Outputting Step\n    |residual|_2 of individual variables:\n               porepressure: 1.19901e+16\n\n    Finished Outputting Step                                                             [  9.76 s] [  196 MB]\n    Computing Jacobian........                                                           [ 47.62 s] [  668 MB]\n\n      0 Linear |R| = 1.199015e+16\n      1 Linear |R| = 2.973917e+06\n\n\n    Computing Residual.......                                                            [ 44.95 s] [    0 MB]\n\n 1 Nonlinear |R| = 3.761817e+06\n\n    Outputting Step\n    |residual|_2 of individual variables:\n               porepressure: 3.76182e+06\n\n    Finished Outputting Step                                                             [  9.77 s] [  196 MB]\n    Computing Jacobian.......                                                            [ 44.05 s] [  183 MB]\n\n      0 Linear |R| = 3.761817e+06\n      1 Linear |R| = 3.872601e+05\n      2 Linear |R| = 1.265769e+05\n      3 Linear |R| = 4.412521e+04\n      4 Linear |R| = 1.956437e+04\n      5 Linear |R| = 1.075743e+04\n      6 Linear |R| = 5.186889e+03\n      7 Linear |R| = 2.359417e+03\n      8 Linear |R| = 1.151951e+03\n      9 Linear |R| = 5.728554e+02\n     10 Linear |R| = 2.826904e+02\n     11 Linear |R| = 1.473774e+02\n     12 Linear |R| = 7.573372e+01\n     13 Linear |R| = 3.684135e+01\n     14 Linear |R| = 2.026634e+01\n     15 Linear |R| = 1.260716e+01\n     16 Linear |R| = 6.966948e+00\n     17 Linear |R| = 3.106520e+00\n\n\n    Computing Residual.......                                                            [ 44.81 s] [    0 MB]\n\n 2 Nonlinear |R| = 6.640826e+05\n\n    Outputting Step\n    |residual|_2 of individual variables:\n               porepressure: 664083\n\n    Finished Outputting Step                                                             [  9.49 s] [  195 MB]\n    Computing Jacobian.......                                                            [ 44.06 s] [    0 MB]\n\n      0 Linear |R| = 6.640826e+05\n      1 Linear |R| = 5.817929e+04\n      2 Linear |R| = 1.215485e+04\n      3 Linear |R| = 3.585853e+03\n      4 Linear |R| = 1.155288e+03\n      5 Linear |R| = 4.159454e+02\n      6 Linear |R| = 1.687421e+02\n      7 Linear |R| = 8.154279e+01\n      8 Linear |R| = 4.054883e+01\n      9 Linear |R| = 2.067672e+01\n     10 Linear |R| = 1.078030e+01\n     11 Linear |R| = 5.283523e+00\n     12 Linear |R| = 2.535468e+00\n     13 Linear |R| = 1.193826e+00\n     14 Linear |R| = 5.702852e-01\n\n\n    Computing Residual.......                                                            [ 44.98 s] [    0 MB]\n\n 3 Nonlinear |R| = 9.605972e+04\n\n    Outputting Step\n    |residual|_2 of individual variables:\n               porepressure: 96059.7\n\n    Finished Outputting Step                                                             [  9.56 s] [  194 MB]\n    Computing Jacobian......                                                             [ 44.09 s] [    0 MB]\n\n      0 Linear |R| = 9.605972e+04\n      1 Linear |R| = 5.217487e+03\n      2 Linear |R| = 6.732547e+02\n      3 Linear |R| = 1.658393e+02\n      4 Linear |R| = 9.334967e+01\n      5 Linear |R| = 4.923358e+01\n      6 Linear |R| = 2.409975e+01\n      7 Linear |R| = 1.045964e+01\n      8 Linear |R| = 4.050910e+00\n      9 Linear |R| = 1.452993e+00\n     10 Linear |R| = 5.323351e-01\n     11 Linear |R| = 1.932140e-01\n     12 Linear |R| = 7.357672e-02\n\n\n    Computing Residual.......                                                            [ 44.73 s] [    0 MB]\n\n 4 Nonlinear |R| = 2.955604e+03\n\n    Outputting Step\n    |residual|_2 of individual variables:\n               porepressure: 2955.6\n\n    Finished Outputting Step                                                             [  9.65 s] [  195 MB]\n    Computing Jacobian.......                                                            [ 44.00 s] [    0 MB]\n\n      0 Linear |R| = 2.955604e+03\n      1 Linear |R| = 1.054611e+02\n      2 Linear |R| = 1.549617e+01\n      3 Linear |R| = 3.543518e+00\n      4 Linear |R| = 1.342340e+00\n      5 Linear |R| = 7.220375e-01\n      6 Linear |R| = 3.574187e-01\n      7 Linear |R| = 1.556171e-01\n      8 Linear |R| = 6.432331e-02\n      9 Linear |R| = 2.400982e-02\n     10 Linear |R| = 8.767491e-03\n     11 Linear |R| = 3.559600e-03\n     12 Linear |R| = 1.556880e-03\n\n\n    Computing Residual.......                                                            [ 45.18 s] [    0 MB]\n\n 5 Nonlinear |R| = 1.550060e+02\n\n    Outputting Step\n    |residual|_2 of individual variables:\n               porepressure: 155.006\n\n    Finished Outputting Step                                                             [  9.53 s] [  194 MB]\nNonlinear solve converged due to CONVERGED_FNORM_ABS iterations 5\n\n Solve Converged!",
                          "url": "https://github.com/idaholab/moose/discussions/22102#discussioncomment-3650234",
                          "updatedAt": "2022-09-15T04:34:23Z",
                          "publishedAt": "2022-09-15T04:34:22Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "ah ok the residuals do start pretty huge.\nAutomatic scaling will still bring them closer to 1, note that by default we actually use it to scale the Jacobian, so it's not going to be on a unity scale.\nshow_var_residual_norms isnt very useful with a single variable.\nI d tighten both relative and absolute NL convergence criteria and see if the result is still wrong in frame2.\nbut you are saying what made a difference was actually the line search?",
                          "url": "https://github.com/idaholab/moose/discussions/22102#discussioncomment-3650335",
                          "updatedAt": "2022-09-15T04:59:51Z",
                          "publishedAt": "2022-09-15T04:59:50Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "Traiwit"
                          },
                          "bodyText": "Hi @GiudGiud, yeh I tried to tighten NL convergence, but it won't go lower than this, simply it will give not converged eventually\nYeah many ways give different results line search is one\npetsc_options_iname = '-pc_type -pc_hypre_type -pc_hypre_boomeramg_strong_threshold'\npetsc_options_value = 'hypre    boomeramg 0.5'\nchanging the 0.5 to 0.6 0.7 0.8 or removing that option completely also changes the result, which is very weird, i thought as long as the simulations are converged around the same residual, they should give the same results\n@WilkAndy is our PorousFlow expert, maybe he knows about this.\nKind regards,\nTraiwit",
                          "url": "https://github.com/idaholab/moose/discussions/22102#discussioncomment-3650460",
                          "updatedAt": "2022-09-15T05:23:38Z",
                          "publishedAt": "2022-09-15T05:23:37Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "if they were fully converged and the solution is unique, then yes they should give the same results.\nCan you try forcing a min number of non linear iterations to maybe like 8 to see if that stabilizes the result?",
                          "url": "https://github.com/idaholab/moose/discussions/22102#discussioncomment-3650688",
                          "updatedAt": "2022-09-15T06:05:17Z",
                          "publishedAt": "2022-09-15T06:05:16Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "Traiwit"
                          },
                          "bodyText": "if they were fully converged and the solution is unique, then yes they should give the same results. Can you try forcing a min number of non linear iterations to maybe like 8 to see if that stabilizes the result?\n\nI didn't know we can set the minimum iterations too, I'll give that a go and report back, thank you @GiudGiud!",
                          "url": "https://github.com/idaholab/moose/discussions/22102#discussioncomment-3651301",
                          "updatedAt": "2022-09-15T07:38:46Z",
                          "publishedAt": "2022-09-15T07:38:46Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "Traiwit"
                          },
                          "bodyText": "Hi @GiudGiud, nl_forced_its = 10 helps but the issue still occurs every now and then\nI think it got something to do with line search or changing solving parameters",
                          "url": "https://github.com/idaholab/moose/discussions/22102#discussioncomment-3695617",
                          "updatedAt": "2022-09-21T01:51:36Z",
                          "publishedAt": "2022-09-21T01:51:36Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "At this point you may want to look at what a residual of 2e2 means for your simulation in terms of physical quantities varying. You ll have to dig in the petsc manual first",
                          "url": "https://github.com/idaholab/moose/discussions/22102#discussioncomment-3696120",
                          "updatedAt": "2022-09-21T03:46:36Z",
                          "publishedAt": "2022-09-21T03:46:34Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "Coming back here, it s tough interpreting residuals because they are:\n\nscaled (if you use scaling)\npreconditioned",
                          "url": "https://github.com/idaholab/moose/discussions/22102#discussioncomment-3764883",
                          "updatedAt": "2022-09-29T17:15:43Z",
                          "publishedAt": "2022-09-29T17:15:43Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "Traiwit"
                          },
                          "bodyText": "Hi @GiudGiud here is my input file:\nI feel like I have less of this problem when using a fullysaturated flow model (much simpler compared to unsaturated flow), the unsaturated flow is much more complex physics-wise\n[Mesh]\nallow_renumbering = false\n[mesh1]\ntype = FileMeshGenerator\nallow_renumbering = false\nfile= PROJECTX_MOOSEMESH_old.inp\n[]\n[]\n\n[UserObjects]\n[initial_mesh]\ntype = SolutionUserObject\nexecute_on = INITIAL\nmesh= PROJECTX_F131_oldmesh6m500rain_noinjection.e\ntimestep = LATEST\nsystem_variables = porepressure\n[]\n[]\n[Functions]\n[./ini_pp]\ntype = PiecewiseConstantFromCSV\nread_prop_user_object = 'BC_csv'\nread_type = 'node'\ncolumn_number = '0'\n[../]\n[equl_pp]\ntype = SolutionFunction\nfrom_variable = porepressure\nsolution = initial_mesh\n[]\n[]\n[ICs]\n[./porepressure]\ntype = FunctionIC\nvariable = porepressure\nfunction = equl_pp\n[../]\n[]\n\n[Preconditioning]\n[./SMP]\ntype = SMP\nfull = true\n[../]\n[]\n[Executioner]\ntype = Steady\nsolve_type = NEWTON\npetsc_options = '-snes_converged_reason'\npetsc_options_iname = '-pc_type -pc_hypre_type -pc_hypre_boomeramg_strong_threshold'\npetsc_options_value = 'hypre    boomeramg 0.5'\nnl_rel_tol = 1e-14\nnl_abs_tol = 2e2\nl_tol = 1e-06\nl_max_its = 100\nnl_max_its = 100\nnl_forced_its = 8\nline_search = 'none'\n[]\n\n[Debug]\nshow_var_residual_norms = true\n[]\n[Modules]\n[./FluidProperties]\n[./the_simple_fluid]\ntype = SimpleFluidProperties\n[../]\n[../]\n[]\n[PorousFlowUnsaturated]\n  porepressure = porepressure\n  coupling_type = Hydro\n  gravity = '0 0 -9.81'\n  fp = the_simple_fluid\n  relative_permeability_exponent = 2\n  relative_permeability_type = Corey\n  residual_saturation = 0.01\n  van_genuchten_alpha = 1E-6\n  van_genuchten_m = 0.6\n  time_unit = years\n[]\n[GlobalParams]\nPorousFlowDictator = dictator\n[]\n\n[Problem]\nmaterial_dependency_check = false\n[]\n\n[Variables]\n[./porepressure]\norder = FIRST\nfamily = LAGRANGE\nscaling = 0.01\n[../]\n[]\n[AuxVariables]\n[./min]\norder = CONSTANT\nfamily = MONOMIAL\n[../]\n[./damage]\norder = CONSTANT\nfamily = MONOMIAL\n[../]\n[./perm_map]\norder = CONSTANT\nfamily = MONOMIAL\n[../]\n[/poro_map]\norder = CONSTANT\nfamily = MONOMIAL\n[../]\n[./darcy_x]\norder = CONSTANT\nfamily = MONOMIAL\n[../]\n[./darcy_y]\norder = CONSTANT\nfamily = MONOMIAL\n[../]\n[./darcy_z]\norder = CONSTANT\nfamily = MONOMIAL\n[../]\n[]\n[AuxKernels]\n[./min]\ntype = ElementLengthAuxsqrtBEH\nvariable = min\nmethod = min\nexecute_on = INITIAL\n[../]\n[./damage]\ntype = MaterialRealAux\nvariable = damage\nproperty = damage\nexecute_on = INITIAL\n[../]\n[./perm_map]\ntype = PorousFlowPropertyAux\nvariable = 'perm_map'\nproperty = permeability\nexecute_on = INITIAL\n[../]\n[./poro_map]\ntype = PorousFlowPropertyAux\nvariable = 'poro_map'\nproperty = porosity\nexecute_on = INITIAL\n[../]\n[./darcy_x]\ntype = PorousFlowDarcyVelocityComponentYearToSec\nvariable = darcy_x\ngravity = '0 0 -9.81'\ncomponent = x\n[../]\n[./darcy_y]\ntype = PorousFlowDarcyVelocityComponentYearToSec\nvariable = darcy_y\ngravity = '0 0 -9.81'\ncomponent = y\n[../]\n[./darcy_z]\ntype = PorousFlowDarcyVelocityComponentYearToSec\nvariable = darcy_z\ngravity = '0 0 -9.81'\ncomponent = z\n[../]\n[]\n\n[Materials]\n[./porosity]\ntype = PorousFlowPorosityConstCSV\nread_prop_user_object = poro_read\n[../]\n[./permeability_1]\ntype = PorousFlowPermeabilityConstCSV\n read_prop_user_object = perm_read\n damage = damage\n [../]\n[./damage1]\ntype = GenericConstantArrayBEH\nprop_name = damage\nread_prop_user_object = damage_read\n [../]\n[]\n\n[MPCbe]\ncsv_file = PROJECTX_MOOSEMPCS_MPCs_dense.csv\nheader = true\n[]\n\n[BCs]\n[./water_grad_lTOPOLSRF_WALLS_SRFSET1]\ntype = FunctionDirichletBC\nvariable = porepressure\nboundary = 'top'\nfunction = ini_pp\n[../]\n[./water_grad_lTOPOLSRF_WALLS_SRFSET2]\ntype = FunctionDirichletBC\nvariable = porepressure\nboundary = 'bottom'\nfunction = ini_pp\n[../]\n[./water_grad_lTOPOLSRF_WALLS_SRFSET3]\ntype = FunctionDirichletBC\nvariable = porepressure\nboundary = 'left'\nfunction = ini_pp\n[../]\n[./water_grad_lTOPOLSRF_WALLS_SRFSET4]\ntype = FunctionDirichletBC\nvariable = porepressure\nboundary = 'right'\nfunction = ini_pp\n[../]\n[./drain_DRAINSRF_Y2011_M11]\ntype = PorousFlowPiecewiseLinearSinkBEH\nvariable = porepressure\nboundary = 'DRAINSRF_Y1996_M01'\npt_vals = '0 1e9'\nmultipliers = '0 1e9'\nflux_function = 1e-1\nv = min\nPT_shift = 0\nuse_mobility = true\nfluid_phase = 0\n[../]\n[./drain_TOPOLSRF_Y2011_M11]\ntype = PorousFlowPiecewiseLinearSinkBEH\nvariable = porepressure\nboundary = 'TOPOLSRF_Y1996_M01'\npt_vals = '-1e9 1e9'\nmultipliers = '-1e9 1e9'\nflux_function = 1e-2\nv = min\nPT_shift = -58860\nfluid_phase = 0\n[../]\n[rainfall_recharge]\n   type = PorousFlowSink\n   boundary = 'TOPOLSRF_Y1996_M01'\n   variable = porepressure\n   flux_function = -500\n []\n[]\n\n[NodalKernels]\n[./bc_river]\ntype = PenaltyDirichletNodalKernel\nvariable = porepressure\nvalue = 0\nboundary = 'TOPO_RIVERSANDLAKES_NSET'\npenalty = 1e10\n[../]\n[]\n\n[UserObjects]\n[./perm_read]\ntype = PropertyReadFile\nprop_file_name = 'PROJECTX_MATPROPS_PERM_new.csv'\nnprop = 8 #kxx kyy kzz kxy kxz kyz Aw Kmax\nread_type = element\n[../]\n[./poro_read]\ntype = PropertyReadFile\nprop_file_name = 'PROJECTX_MATPROPS_PORO.csv'\nnprop = 1\nread_type = element\n[../]\n[./damage_read]\ntype = PropertyReadFile\nprop_file_name = 'EXCHG_0140_LOGP.inp'\nnprop = 1\n read_type = element\n[../]\n[./BC_csv]\ntype = PropertyReadFile\nprop_file_name = 'PROJECTX_G02HTv1_BC_FarFieldRhoGdZ_MOOSE.csv'\nnprop = 1\nread_type = node\n[]\n[]\n\n[Outputs]\nperf_graph = true\n[./run_DRAINSRF_Y2011_M11]\ntype = Exodus\nexecute_on = 'final'\nfile_base = /home/moose/projects/PROJECTX_v2/PROJECTX_F140_oldmesh6m500rain_noinjection\n[../]\n\n[]\n\n\nI've been testing this for quite a bit, and the only thing I clearly noticed is that: different line search methods give different results, while they are converged at the roughly the same point (residual value)\nThanks for coming back to this issue @GiudGiud, I really want a standard [Executioner] block that works with all our hydro problems, tweaking it halfway OR project to project isn't so reliable in a long run\nKind regards,\nTraiwit",
                          "url": "https://github.com/idaholab/moose/discussions/22102#discussioncomment-3768482",
                          "updatedAt": "2022-09-30T03:07:08Z",
                          "publishedAt": "2022-09-30T03:07:07Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "and you have tried automatic scaling? If you do, bump nl_abs_tol = 2e2 down\nAutomatic scaling will tend to normalize the convergence criteria across problems so maybe that's desirable for you.",
                          "url": "https://github.com/idaholab/moose/discussions/22102#discussioncomment-3772985",
                          "updatedAt": "2022-09-30T14:34:19Z",
                          "publishedAt": "2022-09-30T14:34:18Z",
                          "isAnswer": false
                        }
                      }
                    ]
                  }
                }
              }
            ]
          }
        }
      },
      {
        "node": {
          "title": "Sliding at GB",
          "author": {
            "login": "selarem"
          },
          "bodyText": "Dear all,\nIn their work on Salt Rocks' deformation mechanism, colleagues have observed sliding at GB before the\ncracking starts. We are trying to model this feature under MOOSE. I have some development running (almost) fine with PF fracture coupled to  CP, but would like to know if there's a  way in moose to introduce this Sliding at GB without throwing all and restarting from scratch.\nThank you for any help\nSaber",
          "url": "https://github.com/idaholab/moose/discussions/17604",
          "updatedAt": "2022-10-12T13:33:14Z",
          "publishedAt": "2021-04-14T14:32:07Z",
          "category": {
            "name": "Q&A Modules: Phase field"
          },
          "comments": {
            "edges": [
              {
                "node": {
                  "author": {
                    "login": "jiangwen84"
                  },
                  "bodyText": "How do you model your GB? sharp or diffuse interface?\nIf it is sharp, I guess you can use cohesive zone method to model GB sliding.",
                  "url": "https://github.com/idaholab/moose/discussions/17604#discussioncomment-611641",
                  "updatedAt": "2022-07-30T16:30:44Z",
                  "publishedAt": "2021-04-14T19:12:49Z",
                  "isAnswer": true,
                  "replies": {
                    "edges": [
                      {
                        "node": {
                          "author": {
                            "login": "selarem"
                          },
                          "bodyText": "I will be interested in both diffuse and sharp. At room temperature it is mainly sharp, but we expect different behaviour with increasing temperature.",
                          "url": "https://github.com/idaholab/moose/discussions/17604#discussioncomment-615074",
                          "updatedAt": "2022-10-11T10:03:21Z",
                          "publishedAt": "2021-04-15T12:01:03Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "selarem"
                          },
                          "bodyText": "Is there an already programmed meshModifier to split the mesh at the GB ? I am working with randomly generated grains.",
                          "url": "https://github.com/idaholab/moose/discussions/17604#discussioncomment-625881",
                          "updatedAt": "2022-10-11T10:03:21Z",
                          "publishedAt": "2021-04-18T08:53:33Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "jiangwen84"
                          },
                          "bodyText": "Is there an already programmed meshModifier to split the mesh at the GB ? I am working with randomly generated grains.\n\nTake a look at https://mooseframework.inl.gov/source/meshgenerators/BreakMeshByBlockGenerator.html",
                          "url": "https://github.com/idaholab/moose/discussions/17604#discussioncomment-626283",
                          "updatedAt": "2022-10-11T10:03:21Z",
                          "publishedAt": "2021-04-18T12:31:21Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "selarem"
                          },
                          "bodyText": "Back to moose after one year of Abaqus to discover that I could not split my mesh at the GB.\nThe grain number and properties are made at the MAterial block, how to tell the mesh breaker to create interfaces at GB ?\nI have something like:\n[Mesh]\n[./fmg]\ntype = FileMeshGenerator\nfile=eprouvette.msh\n[]\n[]\n[UserObjects]\n[./prop_read]\ntype = ElementPropertyReadFile\nprop_file_name = 'input_euler.txt'\nnprop = 4\nread_type = grain\nngrain = 200\nrand_seed =7777\n[../]\n[]\n\nand at the material block:\n[./elasticity_tensor]\ntype = ComputeElasticityTensorCP\nC_ijkl = '4.9592 2.670 2.670 4.9592 2.670 4.9592 3.111 3.111 3.111'\nfill_method = symmetric9\nread_prop_user_object = prop_read\n[../]\n\nRegards,\nSaber",
                          "url": "https://github.com/idaholab/moose/discussions/17604#discussioncomment-2573388",
                          "updatedAt": "2022-06-09T01:22:35Z",
                          "publishedAt": "2022-04-15T12:18:39Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "Are you trying to create a sideset at the grain boundaries?\nYou can use a SideSetsBetweenSubdomainsGenerator in [Mesh] for that\nOr partition the computation?",
                          "url": "https://github.com/idaholab/moose/discussions/17604#discussioncomment-2574248",
                          "updatedAt": "2022-10-11T10:03:43Z",
                          "publishedAt": "2022-04-15T13:52:03Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "selarem"
                          },
                          "bodyText": "I want to use CZM at GB. So i need to generate\nthese side sets.\nRegards",
                          "url": "https://github.com/idaholab/moose/discussions/17604#discussioncomment-2583130",
                          "updatedAt": "2022-10-11T10:03:43Z",
                          "publishedAt": "2022-04-17T21:45:05Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "Are the grains a separate subdomain? What do you see in the exodus output?\nIf so, then the mesh generator I pointed you to should work\nhttps://mooseframework.inl.gov/source/meshgenerators/SideSetsBetweenSubdomainsGenerator.html",
                          "url": "https://github.com/idaholab/moose/discussions/17604#discussioncomment-2585976",
                          "updatedAt": "2022-10-11T10:03:43Z",
                          "publishedAt": "2022-04-18T13:41:12Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "selarem"
                          },
                          "bodyText": "Lets take an example with 4 grains like in : ~/projects/moose/modules/tensor_mechanics/test/tests/elem_prop_read_user_object/prop_elem_read.i\nis it possible in this case to introduce nodes to make interfaces for CZM to be considered at GB ?\nregards,",
                          "url": "https://github.com/idaholab/moose/discussions/17604#discussioncomment-2592225",
                          "updatedAt": "2022-10-11T10:03:44Z",
                          "publishedAt": "2022-04-19T10:59:43Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "What are the grains in the example? I m not sure.\nThis example has 4 elements and reads data per element.\nIs there a variable defined on these grains? A material property?\nHow do you know what the grain boundaries are?",
                          "url": "https://github.com/idaholab/moose/discussions/17604#discussioncomment-2595681",
                          "updatedAt": "2022-10-11T10:03:50Z",
                          "publishedAt": "2022-04-19T19:20:07Z",
                          "isAnswer": false
                        }
                      },
                      {
                        "node": {
                          "author": {
                            "login": "selarem"
                          },
                          "bodyText": "That is my question from the beginning, how to tell the mesh modifier about the grain boundaries.",
                          "url": "https://github.com/idaholab/moose/discussions/17604#discussioncomment-2599012",
                          "updatedAt": "2022-10-11T10:01:29Z",
                          "publishedAt": "2022-04-20T07:44:47Z",
                          "isAnswer": false
                        }
                      }
                    ]
                  }
                }
              },
              {
                "node": {
                  "author": {
                    "login": "selarem"
                  },
                  "bodyText": "czm_traction_separation_base.i\nczm_patch_test_base.i\nczm_multiple_dimension_base.i\nczm_multiple_action_and_materials.i\nAll of them give error message. We need to modify them to run.\n\n\nLe ven. 29 avr. 2022 \u00e0 02:35, Guillaume Giudicelli ***@***.***>\na \u00e9crit :\n\u2026\n Hello\n\n What do you mean by they are not working? What error are you getting?\n\n Guillaume\n\n \u2014\n Reply to this email directly, view it on GitHub\n <#17604 (reply in thread)>,\n or unsubscribe\n <https://github.com/notifications/unsubscribe-auth/AFBUGDH5MLUCGT4KIPEV7ITVHMVF7ANCNFSM425QTMPA>\n .\n You are receiving this because you authored the thread.Message ID:\n ***@***.***>",
                  "url": "https://github.com/idaholab/moose/discussions/17604#discussioncomment-3848437",
                  "updatedAt": "2022-10-11T09:20:34Z",
                  "publishedAt": "2022-10-11T09:20:34Z",
                  "isAnswer": false,
                  "replies": {
                    "edges": [
                      {
                        "node": {
                          "author": {
                            "login": "GiudGiud"
                          },
                          "bodyText": "They should run with an updated MOOSE?\nWhat error message are you getting?",
                          "url": "https://github.com/idaholab/moose/discussions/17604#discussioncomment-3850341",
                          "updatedAt": "2022-10-11T12:58:13Z",
                          "publishedAt": "2022-10-11T12:58:12Z",
                          "isAnswer": false
                        }
                      }
                    ]
                  }
                }
              },
              {
                "node": {
                  "author": {
                    "login": "selarem"
                  },
                  "bodyText": "could not run it at that time. I will give it a try soon\n\nLe mar. 11 oct. 2022 \u00e0 14:58, Guillaume Giudicelli ***@***.***>\na \u00e9crit :\n\u2026\n They should run with an updated MOOSE?\n What error message are you getting?\n\n \u2014\n Reply to this email directly, view it on GitHub\n <#17604 (reply in thread)>,\n or unsubscribe\n <https://github.com/notifications/unsubscribe-auth/AFBUGDDQSGGTEOEUIRAEFNDWCVP67ANCNFSM425QTMPA>\n .\n You are receiving this because you were mentioned.Message ID:\n ***@***.***>",
                  "url": "https://github.com/idaholab/moose/discussions/17604#discussioncomment-3860652",
                  "updatedAt": "2022-10-12T13:33:15Z",
                  "publishedAt": "2022-10-12T13:33:14Z",
                  "isAnswer": false,
                  "replies": {
                    "edges": []
                  }
                }
              }
            ]
          }
        }
      }
    ]
  }
}